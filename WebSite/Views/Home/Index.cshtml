
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model B2B_SCM.Models.Custom

@section Styles
{
    <link href="/assets/libs/flatpickr/flatpickr.min.css" rel="stylesheet" type="text/css" />
    <link href="/assets/libs/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet" type="text/css" />
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="mt-0 header-title">Transaction Purchase Wheat - SCM</h4>
                    <br />
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label">Date</label>
                            <div class="input-group" style="width: 500px">
                                @Html.TextBoxFor(model => model.DateFrom, "{0:yyyy-MM-dd}", new { @class = "form-control", @type = "date", @id = "DateFrom" })
                                @Html.TextBoxFor(model => model.DateTo, "{0:yyyy-MM-dd}", new { @class = "form-control", @type = "date", @id = "DateTo" })
                                <button type="button" class="btn waves-effect waves-light btn-primary" onclick="load_table()">Apply</button>
                            </div>

                        </div>
                        <div class="col-md-6">
                            <div style="text-align: right">
                                <button type="button" class="btn btn-outline-primary waves-effect waves-light" onclick="OnClickAdd()">New Transaction</button>
                            </div>
                        </div>
                    </div>
                    @*<div style="text-align: right">
                        </div>*@
                    <br />
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover nowrap" id="table_data_index" style="width: 100%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>PNO</th>
                                    <th>Date</th>
                                    <th>Trade Qty</th>
                                    <th>Unit Price</th>
                                    <th>Curr</th>
                                    <th>Shipment From</th>
                                    <th>Shipment To</th>
                                    <th>Origin</th>
                                    <th>Shipper</th>
                                    <th>Seller</th>
                                    <th>Remark</th>
                                    <th>Status</th>
                                    <th>Last Updated By</th>
                                    <th>Last Updated Date</th>
                                    <th hidden>PID</th>
                                    <th hidden>Origin_Code</th>
                                    <th hidden>Shipper_Code</th>
                                    <th hidden>Seller_Code</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@using (Html.BeginForm("submit_new_trx", "home", FormMethod.Post))
{
    <div id="modal_header" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
        <div id="mdlDialog" class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Purchase Wheat - NEW</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- Modal Body -->
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row clearfix">
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Purchase No</label>
                                        @Html.TextBoxFor(model => model.PurchaseNo, new { @class = "form-control", @id = "PurchaseNo", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="mb-3">
                                        <label class="form-label">Trade Qty (MT)</label>
                                        @Html.TextBoxFor(model => model.TradeQty, new { @class = "form-control", @id = "TradeQty", @required = "required" })
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="mb-3">
                                        <label class="form-label">Unit Price / MT</label>
                                        @Html.TextBoxFor(model => model.UnitPrice, new { @class = "form-control", @id = "UnitPrice", @required = "required" })
                                    </div>
                                </div>
                                <div class="col-sm-2">
                                    <div class="mb-3">
                                        <label class="form-label">Curr</label>
                                        @Html.DropDownListFor(model => model.Currency, Model.CurrencyList, new { @class = "form-control", @id = "Currency", @name = "Currency" })
                                    </div>
                                </div>
                            </div>

                            <div class="row clearfix">
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label class="form-label">Shipment Periode (From)</label>
                                        @Html.TextBoxFor(model => model.ShipmentFrom, new { @class = "form-control", @id = "ShipmentFrom", @required = "required", @type = "date" })
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label class="form-label">Shipment Periode (To)</label>
                                        @Html.TextBoxFor(model => model.ShipmentTo, new { @class = "form-control", @id = "ShipmentTo", @required = "required", @type = "date" })
                                    </div>
                                </div>
                            </div>


                            <div class="row clearfix">
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Origin</label>
                                        @*<input type="text" class="selectize-close-btn">*@
                                        @Html.DropDownListFor(model => model.Origin, Model.CountryList, new { @class = "form-control", @id = "Origin", @name = "Origin", @multiple = "multiple" })
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Shipper</label>
                                        @Html.DropDownListFor(model => model.Shipper, Model.BPList_Shipper, new { @class = "form-control", @id = "Shipper", @onchange = "OnChangeSellerShipper()" })
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Seller</label>
                                        @Html.DropDownListFor(model => model.Seller, Model.BPList_Seller, new { @class = "form-control", @id = "Seller", @onchange = "OnChangeSellerShipper()" })
                                    </div>
                                </div>
                            </div>

                            <div class="row clearfix">
                                <div class="col-sm-12">
                                    <label class="form-label">Remark</label>
                                    @Html.TextAreaFor(model => model.Remark, new { @class = "form-control", @id = "Remark" })
                                </div>
                            </div>

                            <h6 class="text_color mb-3 pt-1">Required Document</h6>

                            <div id="_partial_doc_required">
                            </div>
                            @*<div class="row">
                                    <div class="col-sm-4">
                                        @foreach (var item in Model.Custom_List_Doc_Type)
                                        {
                                            if (item.Required)
                                            {
                                                <div class="form-check mb-2 form-check-success">
                                                    <input class="form-check-input rounded-circle" type="checkbox" name="@("txtChk" + item.Id)" id="@("txtChk" + item.Id)" checked disabled>
                                                    <label class="form-check-label" for="@("txtChk" + item.Id)">@item.Name</label>
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="form-check mb-2 form-check-success">
                                                    <input class="form-check-input rounded-circle" type="checkbox" name="@("txtChk" + item.Id)" id="@("txtChk" + item.Id)">
                                                    <label class="form-check-label" for="@("txtChk" + item.Id)">@item.Name</label>
                                                </div>
                                            }
                                        }
                                    </div>
                                    <div class="col-sm-4">
                                        @foreach (var item in Model.Custom_List_Doc_Type2)
                                        {
                                            if (item.Required)
                                            {
                                                <div class="form-check mb-2 form-check-success">
                                                    <input class="form-check-input rounded-circle" type="checkbox" name="@("txtChk" + item.Id)" id="@("txtChk" + item.Id)" checked disabled>
                                                    <label class="form-check-label" for="@("txtChk" + item.Id)">@item.Name</label>
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="form-check mb-2 form-check-success">
                                                    <input class="form-check-input rounded-circle" type="checkbox" name="@("txtChk" + item.Id)" id="@("txtChk" + item.Id)">
                                                    <label class="form-check-label" for="@("txtChk" + item.Id)">@item.Name</label>
                                                </div>
                                            }
                                        }
                                    </div>
                                    <div class="col-sm-4">
                                        @foreach (var item in Model.Custom_List_Doc_Type3)
                                        {
                                            if (item.Required)
                                            {
                                                <div class="form-check mb-2 form-check-success">
                                                    <input class="form-check-input rounded-circle" type="checkbox" name="@("txtChk" + item.Id)" id="@("txtChk" + item.Id)" checked disabled>
                                                    <label class="form-check-label" for="@("txtChk" + item.Id)">@item.Name</label>
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="form-check mb-2 form-check-success">
                                                    <input class="form-check-input rounded-circle" type="checkbox" name="@("txtChk" + item.Id)" id="@("txtChk" + item.Id)">
                                                    <label class="form-check-label" for="@("txtChk" + item.Id)">@item.Name</label>
                                                </div>
                                            }
                                        }
                                    </div>

                                </div>*@
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div style="text-align: right">
                        <a href="#" class="btn btn-outline-danger waves-effect waves-light" data-bs-dismiss="modal">Cancel</a>
                        <button type="submit" class="btn btn-outline-primary waves-effect waves-light" id="btnSubmit" onclick="return OnClickSave()">Submit</button>
                    </div>
                </div>
                <!-- End Modal Body -->
            </div>
        </div>
    </div>
}


@using (Html.BeginForm("submit_edit_trx", "home", FormMethod.Post))
{
    <div id="modal_header_edit" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
        <div class="modal-dialog modal-full-width modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content border border-primary">
                <div class="modal-header">
                    <h4 class="modal-title" id="modalEditTitle">Purchase Wheat - EDIT</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- Modal Body -->
                @Html.HiddenFor(model => model.PurchaseIDE)
                @Html.HiddenFor(model => model.GUID)
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-4">
                            <div class="row clearfix">
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Purchase No</label>
                                        @Html.TextBoxFor(model => model.PurchaseNoE, new { @class = "form-control", @id = "PurchaseNoE", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="mb-3">
                                        <label class="form-label">Trade Qty (MT)</label>
                                        @Html.TextBoxFor(model => model.TradeQtyE, new { @class = "form-control numeric", @id = "TradeQtyE", @required = "required" })
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="mb-3">
                                        <label class="form-label">Unit Price / MT</label>
                                        @Html.TextBoxFor(model => model.UnitPriceE, new { @class = "form-control numeric", @id = "UnitPriceE", @required = "required" })
                                    </div>
                                </div>
                                <div class="col-sm-2">
                                    <div class="mb-3">
                                        <label class="form-label">Curr</label>
                                        @Html.DropDownListFor(model => model.CurrencyE, Model.CurrencyList, new { @class = "form-control", @id = "CurrencyE", @name = "CurrencyE" })
                                    </div>
                                </div>
                            </div>

                            <div class="row clearfix">
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label class="form-label">Shipment Periode (From)</label>
                                        @Html.TextBoxFor(model => model.ShipmentFromE, new { @class = "form-control", @id = "ShipmentFromE", @required = "required", @type = "date" })
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label class="form-label">Shipment Periode (To)</label>
                                        @Html.TextBoxFor(model => model.ShipmentToE, new { @class = "form-control", @id = "ShipmentToE", @required = "required", @type = "date" })
                                    </div>
                                </div>
                            </div>


                            <div class="row clearfix">
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Origin</label>
                                        @Html.DropDownListFor(model => model.OriginE, Model.CountryList, new { @class = "form-control", @id = "OriginE", @multiple = "multiple" })
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Shipper</label>
                                        @Html.DropDownListFor(model => model.ShipperE, Model.BPList_Shipper, new { @class = "form-control text-nowrap", @id = "ShipperE" })
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Seller</label>
                                        @Html.DropDownListFor(model => model.SellerE, Model.BPList_Seller, new { @class = "form-control text-nowrap", @id = "SellerE" })
                                    </div>
                                </div>
                            </div>

                            <div class="row clearfix">
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label class="form-label">Contract No</label>
                                        @Html.TextBoxFor(model => model.ContractNo, new { @class = "form-control", @id = "ContractNo", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="mb-3">
                                        <label class="form-label">Contract Date</label>
                                        @Html.TextBoxFor(model => model.ContractDateString, new { @class = "form-control", @id = "ContractDateString", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                    </div>
                                </div>
                            </div>

                            <div class="row clearfix">
                                <div class="col-sm-12">
                                    <label class="form-label">Remark</label>
                                    @Html.TextAreaFor(model => model.RemarkE, new { @class = "form-control", @id = "RemarkE" })
                                </div>
                            </div>

                            <hr />
                            <div class="row clearfix">
                                <div class="accordion custom-accordion" id="custom-accordion-one">
                                    <div class="card mb-0">
                                        <div class="card-header" id="headingNine">
                                            <h5 class="m-0 position-relative">
                                                <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapseLTC" aria-expanded="true" aria-controls="collapseLTC">
                                                    LTC <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                                </a>
                                            </h5>
                                        </div>
                                        <div id="collapseLTC" class="collapse show">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-sm-3">
                                                        <div class="mb-3">
                                                            <label class="form-label">Comm Date</label>
                                                            @Html.TextBoxFor(model => model.CommDiscDateH, new { @class = "form-control", @id = "CommDiscDateH", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <div class="mb-3">
                                                            <label class="form-label">Comp Date</label>
                                                            @Html.TextBoxFor(model => model.CompDiscDateH, new { @class = "form-control", @id = "CompDiscDateH", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <div class="mb-3">
                                                            <label class="form-label">Dem/Des</label>
                                                            @Html.TextBoxFor(model => model.StatusDesDem, new { @class = "form-control", @id = "StatusDesDem", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <div class="mb-3">
                                                            <label class="form-label">Status</label>
                                                            @Html.TextBoxFor(model => model.StatusDesDemConfirm, new { @class = "form-control", @id = "StatusDesDemConfirm", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                        </div>
                                                    </div>
                                                </div>

                                                <div style="text-align: right">
                                                    <button type="button" class="btn btn-outline-primary waves-effect waves-light" id="btnUpdateLTC" onclick="OnClickLTC()">Update</button>
                                                    @*<button class="btn btn-outline-primary waves-effect waves-light" type="button" onclick="return OnClickUpload()">Upload</button>*@
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion custom-accordion" id="custom-accordion-one">
                                    <div class="card mb-0">
                                        <div class="card-header" id="headingPayment">
                                            <h5 class="m-0 position-relative">
                                                <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapsePayment" aria-expanded="true" aria-controls="collapsePayment">
                                                    Payment Information <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                                </a>
                                            </h5>
                                        </div>
                                        <div id="collapsePayment" class="collapse show">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-sm-4" hidden>
                                                        <div class="mb-3">
                                                            <label class="form-label">Final Unit Price / MT</label>
                                                            @Html.TextBoxFor(model => model.FinalUnitPrice, new { @class = "form-control", @id = "FinalUnitPrice", @name = "FinalUnitPrice", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">Due Date</label>
                                                            <div class="input-group">
                                                                @Html.TextBoxFor(model => model.PaymentDueDate, new { @class = "form-control", @id = "PaymentDueDate" })
                                                                <button class="btn btn-outline-primary waves-effect waves-light" type="button" id="btnUpdateDueDate" onclick="OnSaveDueDateConf()"><i class="fas fa-save"></i></button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">Payment Date</label>
                                                            @Html.TextBoxFor(model => model.PaymentDate, new { @class = "form-control", @id = "PaymentDate", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion custom-accordion" id="custom-accordion-one">
                                    <div class="card mb-0">
                                        <div class="card-header" id="headingRD">
                                            <h5 class="m-0 position-relative">
                                                <a class="custom-accordion-title text-reset d-block collapsed" data-bs-toggle="collapse" href="#collapseRD" aria-expanded="false" aria-controls="collapseRD">
                                                    Required Document <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                                </a>
                                            </h5>
                                        </div>
                                        <div id="collapseRD" class="collapse">
                                            <div class="card-body">
                                                <div id="_partial_doc_requiredE">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-8">
                            <div class="accordion custom-accordion" id="custom-accordion-one">
                                <div class="card mb-0">
                                    <div class="card-header" id="headingNine">
                                        <h5 class="m-0 position-relative">
                                            <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapse1" aria-expanded="true" aria-controls="collapse1">
                                                Detail items <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                            </a>
                                        </h5>
                                    </div>
                                    <div id="collapse1" class="collapse show">
                                        <div class="card-body">
                                            <div style="text-align: right">
                                                <button class="btn btn-outline-primary waves-effect waves-light" type="button" id="btnAddItem" onclick="OnClickNewWheat()">Add Wheat</button>
                                            </div>
                                            <div class="table-responsive">
                                                <table class="table table-striped table-bordered table-hover nowrap" id="table_data_item" style="width: 100%">
                                                    <thead>
                                                        <tr>
                                                            <td rowspan="2">#</td>
                                                            <td rowspan="2">Wheat</td>
                                                            <td rowspan="2">Est. Qty</td>
                                                            <td rowspan="2">Final Qty</td>
                                                            <td rowspan="2">Final Price</td>
                                                            <td rowspan="2">Qty * Price</td>
                                                            <td colspan="4" style="text-align: center; font: bold">Loading Details</td>
                                                            <td colspan="4" style="text-align: center; font: bold">Discharge Details</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Port of Loading</td>
                                                            <td>ETA Load Port</td>
                                                            <td>ETB Load Port</td>
                                                            <td>ETD Load Port</td>
                                                            <td>Port of Discharge</td>
                                                            <td>ETA Disport</td>
                                                            <td>ETB Disport</td>
                                                            <td>ETC Disport</td>
                                                        </tr>
                                                    </thead>
                                                    <tfoot>
                                                        <tr>
                                                            <td colspan="2" style="text-align: center; font: bold">Σ</td>
                                                            <td></td>
                                                            <td></td>
                                                            <td></td>
                                                            <td></td>
                                                            <td colspan="8"></td>
                                                        </tr>
                                                    </tfoot>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card mb-0">
                                    <div class="card-header" id="headingFive">
                                        <h5 class="m-0 position-relative">
                                            <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapse2" aria-expanded="true" aria-controls="collapse2">
                                                Vessel Information <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                            </a>
                                        </h5>
                                    </div>
                                    <div id="collapse2" class="collapse show">
                                        <div class="card-body">
                                            <div class="row clearfix">
                                                <div class="col-sm-3">
                                                    <div class="mb-3">
                                                        <label class="form-label">Vessel Name</label>
                                                        @Html.TextBoxFor(model => model.VesselName, new { @class = "form-control", @id = "VesselName", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="mb-3">
                                                        <label class="form-label">Vessel Detail</label>
                                                        @Html.TextBoxFor(model => model.VesselDetail, new { @class = "form-control", @id = "VesselDetail", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="mb-3">
                                                        <label class="form-label">Demurage/Despatch (Rate)</label>
                                                        @Html.TextBoxFor(model => model.DemDes, new { @class = "form-control", @id = "DemDes", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="mb-3">
                                                        <label class="form-label">Appointed Agent</label>
                                                        @Html.TextBoxFor(model => model.AppointAgent, new { @class = "form-control", @id = "AppointAgent", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card mb-0">
                                    <div class="card-header" id="headingAWB">
                                        <h5 class="m-0 position-relative">
                                            <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapseAWB" aria-expanded="true" aria-controls="collapseAWB">
                                                AWB Information <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                            </a>
                                        </h5>
                                    </div>
                                    <div id="collapseAWB" class="collapse show">
                                        <div class="card-body">
                                            <div class="row clearfix">
                                                <div class="col-sm-12">
                                                    <div class="table-responsive">
                                                        <table class="table table-striped table-bordered table-hover nowrap" id="table_data_awb" style="width: 100%">
                                                            <thead>
                                                                <tr>
                                                                    <th>Awb No</th>
                                                                    <th>Courir</th>
                                                                    <th>Remark</th>
                                                                    <th>By</th>
                                                                    <th>Date</th>
                                                                </tr>
                                                            </thead>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="accordion custom-accordion" id="custom-accordion-one">
                                <div class="card mb-0">
                                    <div class="card-header" id="headingNine">
                                        <h5 class="m-0 position-relative">
                                            <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapse3" aria-expanded="true" aria-controls="collapse3">
                                                Document History <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                            </a>
                                        </h5>
                                    </div>
                                    <div id="collapse3" class="collapse show">
                                        <div class="card-body">
                                            <div style="text-align: right">
                                                <a href="#" class="btn btn-outline-warning waves-effect waves-light" onclick="OnCancelApproved(document.getElementById('PurchaseIDE').value)">Cancel Approve</a>
                                                <button class="btn btn-outline-primary waves-effect waves-light" type="button" id="btnUploadDoc" onclick="return OnClickUpload()">Upload</button>
                                            </div>
                                            <div class="table-responsive">
                                                <table class="table table-striped table-bordered dt-responsive nowrap" id="table_edit_doc" style="width: 100%">
                                                    <thead>
                                                        <tr>
                                                            <th>#</th>
                                                            <th>Doc Type</th>
                                                            <th>Comment</th>
                                                            <th>Status</th>
                                                            <th>By</th>
                                                            <th>Date</th>
                                                            @*<th></th>*@
                                                            <th></th>
                                                            <th></th>
                                                        </tr>
                                                    </thead>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" style="justify-content: normal!important; display:inline!important; text-align: right">
                    <div class="row">
                        <div class="col-sm-4">
                            <button type="submit" class="btn btn-outline-primary waves-effect waves-light" id="btnSubmitHeader" onclick="return OnClickSave()" style="width: 100%">Update Header</button>
                        </div>
                        <div class="col-sm-8">
                            @*<button class="btn btn-outline-primary waves-effect waves-light" type="button" id="btnOpenTrx" onclick="OnOpenTransactionConf()">Open Transaction</button>*@
                            <button class="btn btn-outline-danger waves-effect waves-light" type="button" id="btnCancel" data-bs-dismiss="modal">Cancel</button>
                            <button class="btn btn-outline-warning waves-effect waves-light" type="button" id="btnRefresh" onclick="OnRefreshModal()">Refresh</button>
                            <button class="btn btn-outline-primary waves-effect waves-light" type="button" id="btnOpenCloseTrx" onclick="OnOpenCloseTrx()"></button>
                        </div>
                    </div>
                    @*<div style="text-align: right">
                        </div>*@
                </div>
            </div>
        </div>
    </div>
}


<div id="modal_edit_doc" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">Action</h4>
            </div>
            <div class="modal-body">
                @Html.HiddenFor(model => model.UID)
                <div class="row clearfix">
                    <div class="col-sm-12">
                        <h4 class="form-label">Doc Type&nbsp;&nbsp;&nbsp;&nbsp;: <span style="color: #60b1ff" id="txtDocType"></span></h4>
                    </div>
                </div>
                <div class="row clearfix">
                    <div class="col-sm-12">
                        <h4 class="form-label">Doc Name&nbsp;: <span style="color: #60b1ff" id="txtDocName"></span></h4>
                    </div>
                </div>
                <div class="row clearfix">
                    <div class="col-sm-12">
                        <h4 id="txtAccType" class="form-label">Vendor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span style="color: #60b1ff" id="txtVendor"></span></h4>
                    </div>
                </div>
                <div class="row clearfix">
                    <div class="col-sm-12">
                        <h4 class="form-label">Comments</h4>
                        <textarea id="txtRemark" name="txtRemark" rows="2" class="form-control"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnDocCancel()">Cancel</a>
                    <a href="#" class="btn btn-outline-secondary waves-effect waves-light" onclick="return OnDocActionConf('POSTPONE')">Postpone</a>
                    <a href="#" class="btn btn-outline-primary waves-effect waves-light" onclick="return OnDocActionConf('APPROVED')">Approved</a>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="modal_item" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">Add Wheat</h4>
                @*<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>*@
            </div>
            <!-- Modal Body -->
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="row clearfix">
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Wheat</label>
                                    @Html.DropDownListFor(model => model.WheatCode, Model.WTList, new { @class = "form-control", @id = "WheatCode" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Qty</label>
                                    @Html.TextBoxFor(model => model.WheatQty, new { @class = "form-control", @id = "WheatQty" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Port of discharge</label>
                                    @Html.DropDownListFor(model => model.WheatPort, Model.PortList, new { @class = "form-control", @id = "WheatPort" })
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelItem()">Cancel</a>
                    <button type="button" class="btn btn-outline-primary waves-effect waves-light" id="btnSubmit" onclick="return OnSaveItem()">Submit</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_conversation" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title" id="title-conversation">Coversation</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="conversation-list-card card">
                            <div class="card-body">
                                <div id="_partial_doc_chat" onload="">
                                </div>
                            </div>
                            <div class="p-3 conversation-input border-top">
                                <div class="row">
                                    <div class="col">
                                        <div>
                                            <textarea class="form-control" placeholder="Enter Message..." id="txtChat" name="txtChat" onkeypress="OnEnterSend(event)"></textarea>
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <button type="submit" onclick="OnSend()" class="btn btn-primary chat-send width-md waves-effect waves-light h-auto"><span class="d-none d-sm-inline-block me-2">Send</span> <i class="mdi mdi-send"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div style="text-align: right">
                            <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelConversation()">Cancel</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_history_file" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">History of files</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered dt-responsive nowrap" id="table_history_doc" style="width: 100%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>ID</th>
                                    <th>Doc Type</th>
                                    <th>Comment</th>
                                    <th>Reply</th>
                                    <th>Status</th>
                                    <th>Uploader</th>
                                    <th>Upload Date</th>
                                    <th></th>
                                    <th></th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelHistoryDoc()">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_upload_document" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content border border-info">
            <div class="modal-header">
                <h4 class="modal-title">Upload Document</h4>
                @*<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>*@
            </div>
            <div class="modal-body">
                @Html.HiddenFor(x => x.PurchaseIDE2)
                <div id="_partial_upload_doc">
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelUpload()">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_ltc" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">LTC</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label">Commence Discharge Date</label>
                                        @Html.TextBoxFor(model => model.CommDiscDate, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "CommDiscDate", @name = "CommDiscDate", @type = "text", @style = "color: black;" })
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label">Complete Discharge Date</label>
                                        @Html.TextBoxFor(model => model.CompDiscDate, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "CompDiscDate", @name = "CompDiscDate", @type = "text", @style = "color: black;" })
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label">Status</label>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-check mb-2 form-check-info">
                                                    <input class="form-check-input" type="radio" name="rbDemDes" id="rbDem" value="DEM">
                                                    <label class="form-check-label" for="rbDem">Demurage</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-check mb-2 form-check-info">
                                                    <input class="form-check-input" type="radio" name="rbDemDes" id="rbDes" value="DES">
                                                    <label class="form-check-label" for="rbDes">Despatch</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        @*<div class="col-md-8">
                                <div class="table-responsive">
                                    <table class="table table-striped table-bordered table-hover nowrap" id="table_data_ltc" style="width: 100%">
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>From</th>
                                                <th>Remark</th>
                                                <th>Date</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>*@
                    </div>
                    @*<div class="row">
                            <div class="col-sm-12">
                                <label class="form-label">Laytime Calculation</label>
                                <div class="input-group border border-primary">
                                    <input type="file" class="form-control" id="txtLTCFile" name="txtLTCFile" accept="application/pdf" style="width: 100px!important">
                                    <input type="text" class="form-control" id="txtLTCRemark" name="txtLTCRemark" placeholder="Remark ...">
                                </div>
                            </div>
                        </div>*@
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelLTC()">Cancel</a>
                    <button type="button" class="btn btn-outline-primary waves-effect waves-light" onclick="OnClickSaveLTC()">Update</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_item_edit" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">Edit Wheat</h4>
                @*<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>*@
            </div>
            <!-- Modal Body -->
            <div class="modal-body">
                @Html.HiddenFor(model => model.UID_TrxDtl)
                <div class="row">
                    <div class="col-sm-12">
                        <div class="row clearfix">
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Wheat</label>
                                    @Html.DropDownListFor(model => model.WheatCodeE, Model.WTList, new { @class = "form-control", @id = "WheatCodeE", @name = "WheatCodeE" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Qty</label>
                                    @Html.TextBoxFor(model => model.WheatQtyE, new { @class = "form-control numeric", @id = "WheatQtyE", @name = "WheatQtyE" })
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="mb-3">
                                    <label class="form-label">Port of discharge</label>
                                    @Html.DropDownListFor(model => model.WheatPortE, Model.PortList, new { @class = "form-control", @id = "WheatPortE", @name = "WheatPortE" })
                                </div>
                            </div>
                        </div>

                        <div class="row clearfix">
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">ETA Disport</label>
                                    @Html.TextBoxFor(model => model.ETADisc, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "ETADisc", @name = "ETADisc", @type = "text", @style = "color: black;" })
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">ETB Disport</label>
                                    @Html.TextBoxFor(model => model.ETBDisc, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "ETBDisc", @name = "ETBDisc", @type = "text", @style = "color: black;" })
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">ETC Disport</label>
                                    @Html.TextBoxFor(model => model.ETCDisc, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "ETCDisc", @name = "ETCDisc", @type = "text", @style = "color: black;" })
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelUpdateItem()">Cancel</a>
                    <button type="button" class="btn btn-outline-primary waves-effect waves-light" id="btnSubmitItem" onclick="return OnUpdateItem()">Submit</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_show_password" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title" id="title-conversation-sp"></h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <input type="hidden" id="txtUidDoc" name="txtUidDoc">
                        <div class="mb-3">
                            <label class="form-label">Verification</label>
                            <div class="input-group">
                                <input type="password" id="txtPwdDoc" class="form-control" placeholder="Password login" aria-label="Password login">
                                <button class="btn input-group-text btn-dark waves-effect waves-light" type="button" onclick="return ShowPasswordInfo()">Submit</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="mb-3">
                            <label class="form-label" id="lblPwd"></label>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div style="text-align: right">
                            <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelSP()">Cancel</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_cancel_doc" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">Cancel Approved</h4>
            </div>
            <!-- Modal Body -->
            <div class="modal-body">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered dt-responsive nowrap" id="table_cancel_doc" style="width: 100%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Doc Type</th>
                                    <th>Comment</th>
                                    <th>Status</th>
                                    <th>By</th>
                                    <th>Date</th>
                                    @*<th></th>*@
                                    <th></th>
                                    <th></th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelCancelDoc()">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts
    {
    <script src="/assets/libs/flatpickr/flatpickr.min.js"></script>
    <script src="/assets/libs/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
    @*<script src="~/assets/js/pages/jquery.inputmask.bundle.min.js"></script>*@
    <script src="~/assets/js/jquery.maskmoney.js"></script>
    <script src="https://cdn.datatables.net/plug-ins/1.12.1/api/sum().js"></script>

    <script>
         $("#ETADisc").flatpickr({ dateFormat: "d-m-Y" });
        $("#ETBDisc").flatpickr({ dateFormat: "d-m-Y" });
        $("#ETCDisc").flatpickr({ dateFormat: "d-m-Y" });
        $("#PaymentDueDate").flatpickr({ dateFormat: "d-m-Y" });

        $('#modal_conversation').on('hide.bs.modal', function () {
            load_table_doc(document.getElementById('PurchaseIDE').value);
        })

        function load_table_doc_cancel(id) {
            var table = $('#table_cancel_doc').DataTable();
            table.destroy();
            $('#table_cancel_doc').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_modal_data_doc_cancel", "home")?' + "id=" + id,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": null, "autoWidth": false,
                        mRender: function (data, type, row) {
                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Cancel approved" style="cursor: pointer" onclick="OnClickCancelApprovedConf(\'' + row.UID + '\');"><i class="mdi mdi-book-cancel"></i></span></div>';
                        }
                    },
                    {
                        "data": "DOCTYPE2", "autoWidth": true,
                    },
                    {
                        "data": "REMARK", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "STATUS_NAME", "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.STATUS_CODE == '1') {
                                return '<span style="color: #F4D03F"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '2') {
                                return '<span style="color: red"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '3') {
                                return '<span style="color: green"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else {
                                return '<span style="color: #60b1ff"> ' + row.STATUS_NAME + ' </span>';
                            }
                        }
                    },
                    {
                        "data": "UPLOADER", "autoWidth": true,
                    },
                    {
                        "data": "UPLOAD_DATE", "autoWidth": true,
                    },
                    {
                        "data": "DOCTYPE_ID", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "STATUS_CODE", "autoWidth": true, "visible": false,
                    },
                ],
                "bLengthChange": false,
                "bFilter": false,
                "bPaginate": false,
                "bInfo": false,
                "order": [[7, "desc"]],
            });
        }

        function OnCancelApproved(id) {
            load_table_doc_cancel(document.getElementById('PurchaseIDE').value);
            $('#modal_cancel_doc').modal('show');
        }

        function OnClickCancelCancelDoc() {
            $('#modal_cancel_doc').modal('hide');
        }


        function OnClickCancelApprovedConf(id) {
            Swal.fire({
                title: 'Are you sure want to cancel approve?',
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: !0,
                confirmButtonColor: "#28bb4b",
                cancelButtonColor: "#f34e4e",
                confirmButtonText: "Continue"
            }).then(function (e) {
                e.value && OnClickCancelApproved(id)
            })
        }


        function OnClickCancelApproved(id) {
            var data = {
                Id: id,
            };

            $.ajax({
                type: 'post',
                url: '@Url.Action("Cancel_Approved", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table();
                }
            });
            $('#modal_cancel_doc').modal('hide');
            load_table_doc(document.getElementById("PurchaseIDE").value);
        }

        function OnClickEditItem(id) {
            var data = { id: id };
            $.ajax({
                type: 'GET',
                url: '@Url.Action("get_item", "home")',
                data: data,
                success: function(result) {
                    if (result.success) {
                        document.getElementById('UID_TrxDtl').value = result.UID;
                        document.getElementById('WheatQtyE').value = result.QTY;
                        document.getElementById('ETADisc').value = result.ETADISC;
                        document.getElementById('ETBDisc').value = result.ETBDISC;
                        document.getElementById('ETCDisc').value = result.ETCDISC;

                        var $selectOrigin = $("#WheatCodeE").selectize();
                        var selectizeOrigin = $selectOrigin[0].selectize;
                        selectizeOrigin.setValue(result.WHEATCODE);

                        var $selectShipper = $("#WheatPortE").selectize();
                        var selectizeShipper = $selectShipper[0].selectize;
                        selectizeShipper.setValue(result.DISCPORT);

                        $('#modal_item_edit').modal('show');
                    } else {

                    }
                }
            });
        }

        function OnUpdateItem() {
            var isValid = confirm('Are you sure want to submit/update the transaction?');
            if (isValid == false) {
                return isValid;
            }

            var data = { uid: document.getElementById('UID_TrxDtl').value, wheat: document.getElementById('WheatCodeE').value, port: document.getElementById('WheatPortE').value, qty: document.getElementById('WheatQtyE').value, eta: document.getElementById('ETADisc').value, etb: document.getElementById('ETBDisc').value, etc: document.getElementById('ETCDisc').value, pno: document.getElementById('PurchaseIDE').value };
            $.ajax({
            type: 'post',
            url: '@Url.Action("update_item", "home")',
            data: data,
            success: function(result) {
                if (result.Success) {
                    Swal.fire({
                        title: result.Message,
                        text: "",
                        icon: "info",
                        confirmButtonColor: "#28bb4b",
                        confirmButtonText: "Ok"
                    });

                    load_table_modal_item(document.getElementById('PurchaseIDE').value);
                    $('#modal_item').modal('hide');
                    $('#modal_header_edit').modal('show');
                }
                else {
                    Swal.fire({
                        title: result.Message,
                        text: "",
                        icon: "error",
                        confirmButtonColor: "#28bb4b",
                        confirmButtonText: "Ok"
                    });
                }
            }
            });
            return true;
        }

        function OnClickCancelUpdateItem() {
            $('#modal_item_edit').modal('hide');
        }

        function OnSaveDueDateConf() {
            if (document.getElementById('PaymentDueDate').value == '' || document.getElementById('PaymentDueDate').value == null) {
                Swal.fire({
                    title: "Due Date is blank!",
                    text: "",
                    icon: "error",
                    confirmButtonColor: "#28bb4b",
                    confirmButtonText: "Ok"
                });
            }
            else {
                Swal.fire({
                    title: 'Are you sure want to save this?',
                    text: "You won't be able to revert this!",
                    icon: "warning",
                    showCancelButton: !0,
                    confirmButtonColor: "#28bb4b",
                    cancelButtonColor: "#f34e4e",
                    confirmButtonText: "Continue"
                }).then(function (e) {
                    e.value && OnSaveDueDate()
                })
            }
            return true;
        }

        function OnSaveDueDate() {
            var data = { Id: document.getElementById('PurchaseIDE').value, date: document.getElementById('PaymentDueDate').value };
            $.ajax({
                type: 'post',
                url: '@Url.Action("update_dd", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                }
            });
            return true;
        }

        function OnOpenCloseTrx() {
            var tipe = document.getElementById("btnOpenCloseTrx").innerText;
            if (tipe == "Open Transaction") {
                OnOpenTransactionConf();
            }
            else {
                OnCloseTransactionConf();
            }
        }

        function OnCloseTransactionConf() {
            Swal.fire({
                title: 'Are you sure want to close this transaction?',
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: !0,
                confirmButtonColor: "#28bb4b",
                cancelButtonColor: "#f34e4e",
                confirmButtonText: "Continue"
            }).then(function (e) {
                e.value && OnCloseTransaction()
            })
        }

        function OnCloseTransaction() {
            var data = {
                Id: document.getElementById('PurchaseIDE').value,
            };

            $.ajax({
                type: 'post',
                url: '@Url.Action("close_trx", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table();
                    $('#modal_header_edit').modal('hide');
                }
            });
        }

        function OnOpenTransactionConf() {
            Swal.fire({
                title: 'Are you sure want to open this transaction?',
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: !0,
                confirmButtonColor: "#28bb4b",
                cancelButtonColor: "#f34e4e",
                confirmButtonText: "Continue"
            }).then(function (e) {
                e.value && OnOpenTransaction()
            })
        }

        function OnOpenTransaction() {
            var data = {
                Id: document.getElementById('PurchaseIDE').value,
            };

            $.ajax({
                type: 'post',
                url: '@Url.Action("open_trx", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table();
                    $('#modal_header_edit').modal('hide');
                }
            });
        }

        $(document).ready(function () {
            $("#Origin").selectize(
                {
                    delimiter: ',',
                    plugins: ['remove_button']
                }
            );
            $("#OriginE").selectize({
                delimiter: ',',
                plugins: ['remove_button']
            });
            $("#Shipper").selectize();
            $("#Seller").selectize();

            $("#OriginE").selectize();
            $("#ShipperE").selectize();
            $("#SellerE").selectize();

            $("#WheatCode").selectize();
            $("#WheatPort").selectize();

            $("#Currency").selectize();
            $("#CurrencyE").selectize();

            $('.numeric').maskMoney();

            $("#CommDiscDate").flatpickr({ dateFormat: "d-m-Y" });
            $("#CompDiscDate").flatpickr({ dateFormat: "d-m-Y" });

            load_table();
        })

        function OnRefreshModal() {
            OnClickEdit(document.getElementById('GUID').value);
        }

        function OnClickLTC() {
            $('#modal_ltc').modal('show');
        }

        function OnClickCancelLTC() {
            $('#modal_ltc').modal('hide');
        }

        function OnClickSaveLTC() {
            var status;
            if (document.getElementById('rbDem').checked) {
                status = 'DEM';
            }
            else {
                status = 'DES';
            }

            var data = {
                PurchaseNo: document.getElementById('PurchaseIDE').value,
                commDate: document.getElementById('CommDiscDate').value,
                compDate: document.getElementById('CompDiscDate').value,
                status: status
                //dueDate: document.getElementById('PayDueDate').value
            };

            $.ajax({
                type: 'post',
                url: '@Url.Action("update_ltc", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table_doc(document.getElementById("PurchaseIDE").value);
                }
            });
            OnRefreshModal();
            $('#modal_header_edit').modal('show');
            $('#modal_ltc').modal('hide');
            return true;
        }

        function OnChangeSellerShipper() {
            $('#_partial_doc_required').load('@Url.Action("_partial_doc_required", "home")?seller=' + document.getElementById('Seller').value + '&shipper=' + document.getElementById('Shipper').value);
        }

        $('#modal_conversation').on('shown.bs.modal', function () {
            document.getElementById('txtChat').value = '';
            document.getElementById('txtChat').focus();
        })

        function OnClickNewWheat() {
            $('#modal_item').modal('show');
        }

        function OnClickCancelItem() {
            $('#modal_item').modal('hide');
        }

        function OnClickSave() {
            var isValid = confirm('Are you sure want to submit/update the transaction?');
            if (isValid == false) {
                return isValid;
            }
        }

        function OnClickAdd() {
            document.getElementById('PurchaseNo').value = 'AUTOMATIC';

            var $selectCurr = $("#Currency").selectize();
            var selectizeCurr = $selectCurr[0].selectize;
            selectizeCurr.setValue('USD');

            $('#modal_header').modal('show');
        }

        $('#modal_upload_document').on('hide.bs.modal', function () {
            OnRefreshModal();
        })

        function OnClickEdit(id) {
            document.getElementById('PurchaseIDE').value = null;
            document.getElementById('PurchaseNoE').value = null;
            document.getElementById('TradeQtyE').value = null;
            document.getElementById('UnitPriceE').value = null;
            document.getElementById('ShipmentFromE').value = null;
            document.getElementById('ShipmentToE').value = null;
            document.getElementById('RemarkE').value = null;
            document.getElementById('ContractNo').value = null;
            document.getElementById('ContractDateString').value = null;

            var $selectOrigin = $("#OriginE").selectize();
            var selectizeOrigin = $selectOrigin[0].selectize;
            selectizeOrigin.setValue('');

            var $selectShipper = $("#ShipperE").selectize();
            var selectizeShipper = $selectShipper[0].selectize;
            selectizeShipper.setValue('');

            var $selectSeller = $("#SellerE").selectize();
            var selectizeSeller = $selectSeller[0].selectize;
            selectizeSeller.setValue('');

            var $selectCurr = $("#CurrencyE").selectize();
            var selectizeCurr = $selectCurr[0].selectize;
            selectizeCurr.setValue('');

            document.getElementById('CommDiscDate').value = null;
            document.getElementById('CompDiscDate').value = null;

            document.getElementById('CommDiscDateH').value = null;
            document.getElementById('CompDiscDateH').value = null;
            document.getElementById('StatusDesDem').value = null;
            document.getElementById('StatusDesDemConfirm').value = null;

            $("#rbDem").prop("checked", false);
            $("#rbDes").prop("checked", false);

            var data = { id: id };
            $.ajax({
                type: 'GET',
                url: '@Url.Action("get_header_trx", "home")',
                data: data,
                success: function(result) {
                    if (result.success) {
                        document.getElementById('modalEditTitle').innerHTML = 'Purchase Wheat - EDIT (#' + result.PurchaseNo + ') - SCM';
                        document.getElementById('GUID').value = result.Guid;
                        document.getElementById('PurchaseIDE').value = result.PurchaseIDE;
                        document.getElementById('PurchaseNoE').value = result.PurchaseNo;
                        document.getElementById('TradeQtyE').value = result.TradeQty;
                        document.getElementById('UnitPriceE').value = result.UnitPrice;
                        document.getElementById('ShipmentFromE').value = result.ShipmentFrom;
                        document.getElementById('ShipmentToE').value = result.ShipmentTo;
                        document.getElementById('RemarkE').value = result.Remark;
                        document.getElementById('ContractNo').value = result.ContractNo;
                        document.getElementById('ContractDateString').value = result.ContractDate;

                        selectizeShipper.setValue(result.Shipper);

                        selectizeSeller.setValue(result.Seller);

                        selectizeCurr.setValue(result.Currency);

                        $('#_partial_doc_requiredE').load('@Url.Action("_partial_doc_required", "home")?mode=E&seller=' + document.getElementById('SellerE').value + '&shipper=' + document.getElementById('ShipperE').value + '&pid=' + result.PurchaseIDE);

                        load_table_modal_item(result.PurchaseIDE);
                        load_table_doc(result.PurchaseIDE);
                        GetVesselInfo(result.PurchaseIDE);
                        load_table_awb(result.PurchaseIDE);

                        document.getElementById('CommDiscDate').value = result.CommDiscDate;
                        document.getElementById('CompDiscDate').value = result.CompDiscDate;

                        document.getElementById('CommDiscDateH').value = result.CommDiscDate;
                        document.getElementById('CompDiscDateH').value = result.CompDiscDate;
                        document.getElementById('StatusDesDem').value = result.StatusDesDem;
                        document.getElementById('StatusDesDemConfirm').value = result.StatusDesDemConfirm;

                        if (result.StatusDesDem == "DEM") {
                            $("#rbDem").prop("checked", true);
                        }
                        else {
                            $("#rbDes").prop("checked", true);
                        }

                        document.getElementById('FinalUnitPrice').value = result.FinalUnitPrice;
                        document.getElementById('PaymentDueDate').value = result.PaymentDueDate;
                        document.getElementById('PaymentDate').value = result.PaymentDate;

                        if (result.Closed == "1") {
                            document.getElementById("btnSubmitHeader").disabled = true;
                            //document.getElementById("btnCloseTrx").style.display = 'none'
                            //document.getElementById("btnOpenTrx").style.display = 'block'
                            document.getElementById("btnAddItem").disabled = true;
                            document.getElementById("btnUpdateLTC").disabled = true;
                            document.getElementById("btnUpdateDueDate").disabled = true;
                            document.getElementById("btnSubmitItem").disabled = true;
                            document.getElementById("btnUploadDoc").disabled = true;

                            document.getElementById("btnOpenCloseTrx").innerHTML = "Open Transaction";
                        }
                        else {
                            document.getElementById("btnSubmitHeader").disabled = false;
                            //document.getElementById("btnCloseTrx").style.display = 'block'
                            //document.getElementById("btnOpenTrx").style.display = 'none'
                            document.getElementById("btnAddItem").disabled = false;
                            document.getElementById("btnUpdateLTC").disabled = false;
                            document.getElementById("btnUpdateDueDate").disabled = false;
                            document.getElementById("btnSubmitItem").disabled = false;
                            document.getElementById("btnUploadDoc").disabled = false;

                            document.getElementById("btnOpenCloseTrx").innerHTML = "Close Transaction";
                        }

                        const orgn = [];
                        for (orgns of result.Origin.split(",")) {
                            orgn.push(orgns);
                        }
                        selectizeOrigin.setValue(orgn);

                        $('#modal_header_edit').modal('show');
                    } else {

                    }
                }
            });
        }

        function GetVesselInfo(id) {
            var data = { id: id };
            $.ajax({
                type: 'GET',
                url: '@Url.Action("get_header_vessel", "shipper")',
                data: data,
                success: function(result) {
                    if (result.success) {
                        document.getElementById('VesselName').value = result.VESSELNAME;
                        document.getElementById('VesselDetail').value = result.VESSELDETAIL;
                        document.getElementById('DemDes').value = result.RATES;
                        document.getElementById('AppointAgent').value = result.APPOINTAGENT;
                    } else {

                    }
                }
            });
        }

        function load_table() {
            var table = $('#table_data_index').DataTable();
            table.destroy();

            $('#table_data_index').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_data_index", "home")?' + "fromDate=" + document.getElementById('DateFrom').value + "&toDate=" + document.getElementById('DateTo').value,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": "GUID", "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.CLOSED == false) {
                                return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Edit" style="cursor: pointer" onclick="OnClickEdit(\'' + row.GUID + '\');"><i class="dripicons-document-edit"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Delete" style="cursor: pointer" onclick="OnClickDelete(\'' + row.PURCHASENO2 + '\');"><i class="dripicons-trash"></i></span></div>';
                            }
                            else {
                                return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="View" style="cursor: pointer" onclick="OnClickEdit(\'' + row.GUID + '\');"><i class="dripicons-preview"></i></span></div>';
                            }
                            //else {
                            //    return '<div style="text-align: center;font-size: 20px"><span data-plugin="tippy" data-tippy-placement="top" title="Restore" style="cursor: pointer" onclick="OnClickRestore(\'' + row.PURCHASENO2 + '\');"><i class="dripicons-time-reverse"></i></span></div>';
                            //}
                        }
                    },
                    {
                        "data": "PNO", "autoWidth": true,
                    },
                    {
                        "data": "DATE", "autoWidth": true,
                    },
                    {
                        "data": "TRADEQTY", "autoWidth": true,
                    },
                    {
                        "data": "UNITPRICE", "autoWidth": true,
                    },
                    {
                        "data": "CURRENCY", "autoWidth": true,
                    },
                    {
                        "data": "SHIPMENTFROM", "autoWidth": true,
                    },
                    {
                        "data": "SHIPMENTTO", "autoWidth": true,
                    },
                    {
                        "data": "ORIGIN_NAME", "autoWidth": true,
                    },
                    {
                        "data": "SHIPPER_NAME", "autoWidth": true,
                    },
                    {
                        "data": "SELLER_NAME", "autoWidth": true,
                    },
                    {
                        "data": "REMARK", "autoWidth": true,
                    },
                    {
                        "data": "CLOSED", "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.CLOSED == false) {
                                return '<span style="color: #60b1ff"> Open </span>';
                            }
                            else {
                                return '<span style="color: red"> Close </span>';
                            }
                        }
                    },
                    {
                        "data": "UPDBY", "autoWidth": true,
                    },
                    {
                        "data": "UPDDATE", "autoWidth": true,
                    },
                    {
                        "data": "PURCHASENO2", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "ORIGIN", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "SHIPPER", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "SELLER", "autoWidth": true, "visible": false,
                    },
                ],
                "bLengthChange": true,
                "bFilter": true,
                "order": [[1, "desc"]],
                scrollX: true,
            });
        }

        function load_table_modal_item(id) {
            var table = $('#table_data_item').DataTable();
            table.destroy();
            $('#table_data_item').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_modal_data_item", "home")?' + "id=" + id,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": null, "autoWidth": true,
                        mRender: function (data, type, row) {
                            return '<span data-toggle="tooltip" title="Edit" style="cursor: pointer" onclick="OnClickEditItem(\'' + row.UID + '\');"><i class="dripicons-document-edit"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Delete" style="cursor: pointer" onclick="return OnClickDeleteItem(\'' + row.UID + '\');"><i class="dripicons-trash"></i></span>';
                        }
                    },
                    {
                        "data": "WHEATNAME", "autoWidth": true,
                    },
                    {
                        "data": "QTY_C", "autoWidth": true,
                    },
                    {
                        "data": "FQTY_C", "autoWidth": true,
                    },
                    {
                        "data": "FINALPRICE", "autoWidth": true,
                    },
                    {
                        "data": "PRICE", "autoWidth": true,
                    },
                    {
                        "data": "LOADPORTNAME", "autoWidth": true,
                    },
                    {
                        "data": "ETALOAD", "autoWidth": true,
                    },
                    {
                        "data": "ETBLOAD", "autoWidth": true,
                    },
                    {
                        "data": "ETDLOAD", "autoWidth": true,
                    },
                    {
                        "data": "DISCPORTNAME", "autoWidth": true,
                    },
                    {
                        "data": "ETADISC", "autoWidth": true,
                    },
                    {
                        "data": "ETBDISC", "autoWidth": true,
                    },
                    {
                        "data": "ETCDISC", "autoWidth": true,
                    },
                ],
                "bLengthChange": false,
                "bFilter": false,
                "bPaginate": false,
                "bInfo": false,
                "order": [[1, "asc"]],
                drawCallback: function () {
                    var api = this.api();
                    var sum = 0;
                    var formated = 0;
                    $(api.column(2).footer()).html('Total');
                    sum = api.column(2, { page: 'current' }).data().sum();
                    formated = parseFloat(sum).toLocaleString(undefined, { minimumFractionDigits: 2 });
                    $(api.column(2).footer()).html(formated);

                    $(api.column(3).footer()).html('Total');
                    sum = api.column(3, { page: 'current' }).data().sum();
                    formated = parseFloat(sum).toLocaleString(undefined, { minimumFractionDigits: 2 });
                    $(api.column(3).footer()).html(formated);

                    $(api.column(5).footer()).html('Total');
                    sum = api.column(5, { page: 'current' }).data().sum();
                    formated = parseFloat(sum).toLocaleString(undefined, { minimumFractionDigits: 2 });
                    $(api.column(5).footer()).html(formated);
                    //for (var i = 3; i < 4; i++) {
                    //    sum = api.column(3, { page: 'current' }).data().sum();
                    //    formated = parseFloat(sum).toLocaleString(undefined, { minimumFractionDigits: 2 });
                    //    $(api.column(3).footer()).html('$' + formated);
                    //}

                }
            });

            //var table2 = $('#table_data_item').DataTable();
            //table2.column(3).data().sum();
        }

        function ShowPasswordDoc(id, doctype) {
            document.getElementById('lblPwd').innerHTML = '';
            document.getElementById('txtPwdDoc').value = '';
            document.getElementById('title-conversation-sp').innerHTML = 'Password for ' + doctype;
            document.getElementById('txtUidDoc').innerHTML = id;
            document.getElementById('txtUidDoc').value = id;
            $('#modal_show_password').modal('show');
        }

        function ShowPasswordInfo() {
            var uid = document.getElementById('txtUidDoc').value;
            var pwd = document.getElementById('txtPwdDoc').value;
            var data = { id: uid, pwd: pwd };
            $.ajax({
                type: 'POST',
                url: '@Url.Action("get_pwd_doc", "home")',
                data: data,
                success: function(result) {
                    document.getElementById('lblPwd').innerHTML = result.Message;
                }
            });
            document.getElementById('txtPwdDoc').value = '';
            return true;
        }

        function OnClickCancelSP() {
            $('#modal_show_password').modal('hide');
        }

        function load_table_doc(id) {
            var table = $('#table_edit_doc').DataTable();
            table.destroy();
            $('#table_edit_doc').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_modal_data_doc", "home")?' + "id=" + id,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": null, "autoWidth": false,
                        mRender: function (data, type, row) {
                            if (row.STATUS_CODE == '1') {
                                if (row.TOTAL_CHAT != "0") {
                                    if (row.SECURE == "1") {
                                        return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Edit" style="cursor: pointer" onclick="OnDocEdit(\'' + row.UID + '\');"><i class="dripicons-document-edit"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Show Password" style="cursor: pointer" onclick="ShowPasswordDoc(\'' + row.UID + '\');"><i class="dripicons-preview"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                    }
                                    else {
                                        return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Edit" style="cursor: pointer" onclick="OnDocEdit(\'' + row.UID + '\');"><i class="dripicons-document-edit"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                    }
                                }
                                else {
                                    if (row.SECURE == "1") {
                                        return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Edit" style="cursor: pointer" onclick="OnDocEdit(\'' + row.UID + '\');"><i class="dripicons-document-edit"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Show Password" style="cursor: pointer" onclick="ShowPasswordDoc(\'' + row.UID + '\');"><i class="dripicons-preview"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                    }
                                    else {
                                        return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Edit" style="cursor: pointer" onclick="OnDocEdit(\'' + row.UID + '\');"><i class="dripicons-document-edit"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                    }
                                }
                            }
                            else {
                                if (row.AUTH == "1") {
                                    if (row.TOTAL_CHAT != "0") {
                                        if (row.SECURE == "1") {
                                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Show Password" style="cursor: pointer" onclick="ShowPasswordDoc(\'' + row.UID + '\',\'' + row.DOCTYPE2 + '\');"><i class="dripicons-preview"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Delete" style="cursor: pointer" onclick="OnConfirmDeleteDocument(\'' + row.UID + '\');"><i class="dripicons-document-delete"></i></span></div>';

                                        }
                                        else {
                                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Delete" style="cursor: pointer" onclick="OnConfirmDeleteDocument(\'' + row.UID + '\');"><i class="dripicons-document-delete"></i></span></div>';
                                        }
                                    }
                                    else {
                                        if (row.SECURE == "1") {
                                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Show Password" style="cursor: pointer" onclick="ShowPasswordDoc(\'' + row.UID + '\',\'' + row.DOCTYPE2 + '\');"><i class="dripicons-preview"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Delete" style="cursor: pointer" onclick="OnConfirmDeleteDocument(\'' + row.UID + '\');"><i class="dripicons-document-delete"></i></span></div>';

                                        }
                                        else {
                                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Delete" style="cursor: pointer" onclick="OnConfirmDeleteDocument(\'' + row.UID + '\');"><i class="dripicons-document-delete"></i></span></div>';
                                        }
                                    }
                                }
                                else {
                                    if (row.TOTAL_CHAT != "0") {
                                        if (row.SECURE == "1") {
                                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Show Password" style="cursor: pointer" onclick="ShowPasswordDoc(\'' + row.UID + '\',\'' + row.DOCTYPE2 + '\');"><i class="dripicons-preview"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';

                                        }
                                        else {
                                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                        }
                                    }
                                    else {
                                        if (row.SECURE == "1") {
                                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Show Password" style="cursor: pointer" onclick="ShowPasswordDoc(\'' + row.UID + '\',\'' + row.DOCTYPE2 + '\');"><i class="dripicons-preview"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';

                                        }
                                        else {
                                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="mdi mdi-forum-outline"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                        }
                                    }
                                }
                            }
                        }
                    },
                    {
                        "data": "DOCTYPE2", "autoWidth": true,
                    },
                    {
                        "data": "REMARK", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "STATUS_NAME", "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.STATUS_CODE == '1') {
                                return '<span style="color: #F4D03F"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '2') {
                                return '<span style="color: red"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '3') {
                                return '<span style="color: green"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else {
                                return '<span style="color: #60b1ff"> ' + row.STATUS_NAME + ' </span>';
                            }
                        }
                    },
                    {
                        "data": "UPLOADER", "autoWidth": true,
                    },
                    {
                        "data": "UPLOAD_DATE", "autoWidth": true,
                    },
                    {
                        "data": "DOCTYPE_ID", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "STATUS_CODE", "autoWidth": true, "visible": false,
                    },
                ],
                "bLengthChange": false,
                "bFilter": false,
                "bPaginate": false,
                "bInfo": false,
                "order": [[7, "desc"]],
            });
        }

        function load_table_history_doc(type, uid) {
            $('#modal_history_file').modal('show');
            var pno = document.getElementById('PurchaseIDE').value;
            var table = $('#table_history_doc').DataTable();
            table.destroy();
            $('#table_history_doc').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_modal_history_doc", "home")?pno=' + pno + '&type=' + type + '&id=' + uid,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": null, "autoWidth": false,
                        mRender: function (data, type, row) {
                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span></div>';
                        }
                    },
                    {
                        "data": "UID", "autoWidth": true,
                    },
                    {
                        "data": "DOCTYPE2", "autoWidth": true,
                    },
                    {
                        "data": "REMARK", "autoWidth": true,
                    },
                    {
                        "data": "FEEDBACK", "autoWidth": true,
                    },
                    {
                        "data": "STATUS_NAME", "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.STATUS_CODE == '1') {
                                return '<span style="color: #F4D03F"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '2') {
                                return '<span style="color: red"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '3') {
                                return '<span style="color: green"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else {
                                return '<span style="color: #60b1ff"> ' + row.STATUS_NAME + ' </span>';
                            }
                        }
                    },
                    {
                        "data": "UPLOADER", "autoWidth": true,
                    },
                    {
                        "data": "UPLOAD_DATE", "autoWidth": true,
                    },
                    {
                        "data": "DOCTYPE_ID", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "STATUS_CODE", "autoWidth": true, "visible": false,
                    },
                ],
                "bLengthChange": false,
                "bFilter": false,
                "bPaginate": false,
                "bInfo": false,
                "order": [[1, "desc"]],
            });
        }

        function load_table_awb(id) {
            var table = $('#table_data_awb').DataTable();
            table.destroy();
            $('#table_data_awb').DataTable({
            "ajax": {
                "url": '@Url.Action("load_modal_awb", "home")?pno=' + id,
                "type": "GET",
                "datatype": "json",
                dataSrc: function(data) {
                    return $.parseJSON(data.data);
                }
            },
            "columns": [
                {
                    "data": "AWB", "autoWidth": true,
                },
                {
                    "data": "COURIER", "autoWidth": true,
                },
                {
                    "data": "REMARK", "autoWidth": true,
                },
                {
                    "data": "UPDBY", "autoWidth": true,
                },
                {
                    "data": "UPDDATE", "autoWidth": true,
                },
            ],
            "bLengthChange": false,
            "bFilter": false,
            "bPaginate": false,
            "bInfo": false,
            "order": [[1, "desc"]],
            });
        }

        function OnConfirmDeleteDocument(id_) {
            Swal.fire({
                title: 'Are you sure want to delete this document?',
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: !0,
                confirmButtonColor: "#28bb4b",
                cancelButtonColor: "#f34e4e",
                confirmButtonText: "Continue"
            }).then(function (e) {
                e.value && OnDeleteDocument(id_)
            })
            return true;
        }

        function OnDownload(id_) {
            var data = { Id: id_ };
            $.ajax({
                type: 'post',
                url: '@Url.Action("download", "seller")',
                data: data,
                success: function(result) {
                    if (!result.Success) {
                        Swal.fire({
                            title: "<span style='color:#71b6f9'>" + result.Message + "</span>",
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                }
            });
        }

        function OnDeleteDocument(id_) {
            var data = { Id: id_, purchaseno: document.getElementById("PurchaseIDE").value };
            $.ajax({
                type: 'post',
                url: '@Url.Action("delete_doc", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table_doc(document.getElementById("PurchaseIDE").value);
                }
            });
            return true;
        }

        function OnSaveItem(id_) {
            var isValid = confirm('Are you sure want to submit/update the transaction?');
            if (isValid == false) {
                return isValid;
            }

            var data = { id: document.getElementById('PurchaseIDE').value, wheat: document.getElementById('WheatCode').value, port: document.getElementById('WheatPort').value, qty: document.getElementById('WheatQty').value };
            $.ajax({
            type: 'post',
            url: '@Url.Action("submit_new_trx_item", "home")',
            data: data,
            success: function(result) {
                if (result.Success) {
                    Swal.fire({
                        title: result.Message,
                        text: "",
                        icon: "info",
                        confirmButtonColor: "#28bb4b",
                        confirmButtonText: "Ok"
                    });

                    load_table_modal_item(document.getElementById('PurchaseIDE').value);
                    $('#modal_item').modal('hide');
                    $('#modal_header_edit').modal('show');
                }
                else {
                    Swal.fire({
                        title: result.Message,
                        text: "",
                        icon: "error",
                        confirmButtonColor: "#28bb4b",
                        confirmButtonText: "Ok"
                    });
                }
            }
            });
            return true;
        }

        function OnClickDelete(id_) {
            var isValid = confirm('Are you sure want to deactivated the transaction?');
            if (isValid == false) {
                return isValid;
            }
              var url = '@Url.Action("active_deactive_trx", "home")';
            var data = { id: id_, status: '0' };
              $.post(url, data, function (result) {
                  Swal.fire(
                      "Transaction successfully deactivated!",
                      '',
                      'info'
                  );

                  load_table();
            });
            return true;
        }

        function OnClickRestore(id_) {
            var isValid = confirm('Are you sure want to activated the transaction?');
            if (isValid == false) {
                return isValid;
            }
              var url = '@Url.Action("active_deactive_trx", "home")';
            var data = { id: id_, status: '1' };
              $.post(url, data, function (result) {
                  Swal.fire(
                      "Transaction successfully activated!",
                      '',
                      'info'
                  );

                  load_table();
            });
            return true;
        }

        function OnClickDeleteItem(id_) {
            var isValid = confirm('Are you sure want to delete permanently the item?');
            if (isValid == false) {
                return isValid;
            }
            alert(id_);
            var data = { id: id_, purchaseno: document.getElementById('PurchaseIDE').value };
            $.ajax({
                type: 'post',
                url: '@Url.Action("submit_delete_trx_item", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table_modal_item(document.getElementById('PurchaseIDE').value);
                }
            });

            return true;
        }

        function OnDocCancel() {
            $('#modal_edit_doc').modal('hide');
        }

        function OnDocEdit(uid) {
            var data = { uid: uid };
            $.ajax({
                type: 'GET',
                url: '@Url.Action("get_detail_doc", "home")',
                data: data,
                success: function(result) {
                    if (result.success) {

                        document.getElementById('UID').value = result.UID;
                        document.getElementById('txtDocType').innerHTML = result.NAME;
                        document.getElementById('txtDocName').innerHTML = result.ATTACHMENTNAME;
                        document.getElementById('txtVendor').innerHTML = result.VENDORNAME;
                        document.getElementById('txtRemark').value = '';
                        document.getElementById('txtRemark').focus();
                        //document.getElementById('txtAccType').innerHTML = result.ACCOUNTTYPE + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ';
                        $('#modal_edit_doc').modal('show');
                    } else {
                        Swal.fire(
                            result.Message,
                            '',
                            'error'
                        );
                    }
                }
            });
        }

        function OnDocActionConf(type) {
            Swal.fire({
                title: 'Are you sure want to ' + type +' the item?',
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: !0,
                confirmButtonColor: "#28bb4b",
                cancelButtonColor: "#f34e4e",
                confirmButtonText: "Continue"
            }).then(function (e) {
                e.value && OnDocAction(type)
            })

        }

        function OnDocAction(type) {
            var data = { uid: document.getElementById('UID').value, type: type, remark: document.getElementById('txtRemark').value };
            $.ajax({
                type: 'POST',
                url: '@Url.Action("update_status_doc", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire(
                            result.Message,
                            '',
                            'info'
                        );
                        $('#modal_edit_doc').modal('hide');
                        load_table_doc(result.PurchaseNo);
                    } else {
                        Swal.fire(
                            result.Message,
                            '',
                            'error'
                        );
                    }
                }
            });
        }

        function OnConversation(id,type) {
            document.getElementById('title-conversation').innerHTML = 'Conversation (' + type + ')';
            $("#_partial_doc_chat").load('@Url.Action("_partial_doc_chat", "home")?uid=' + id, function () {
                var d = $('#divChat');
                d.scrollTop(d.prop("scrollHeight"));
                $('#modal_conversation').modal('show');
            });
        }

        function OnEnterSend(e) {
            if (e.keyCode === 13) {
                e.preventDefault(); // Ensure it is only this code that runs
                OnSend();
            }
        }

        function OnSend() {
            var data = { uid: document.getElementById('UID_Chat').value, remark: document.getElementById('txtChat').value };
            $.ajax({
                type: 'post',
                url: '@Url.Action("insert_chat", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        document.getElementById('txtChat').value = '';
                        $('#_partial_doc_chat').load('@Url.Action("_partial_doc_chat", "home")?uid=' + document.getElementById('UID_Chat').value);
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table_doc(document.getElementById("PurchaseIDE").value);
                }
            });
            return true;
        }

        function OnClickCancelConversation() {
            var chat = document.getElementById('txtChat').value.trim();
            if (chat != "") {
                var isValid = confirm('Changes that you made may not be saved, leave site?');
                if (isValid == false) {
                    return isValid;
                }
            }
            $('#modal_conversation').modal('hide');
            return true;
        }

        function OnClickCancelHistoryDoc() {
            $('#modal_history_file').modal('hide');
        }

        function OnClickUpload() {
            $('#_partial_upload_doc').load('@Url.Action("_partial_upload_doc", "home")?id=' + document.getElementById('PurchaseIDE').value);
            document.getElementById('PurchaseIDE2').value = document.getElementById('PurchaseIDE').value;
            //$('#modal_header_edit').modal('hide');
            $('#modal_upload_document').modal('show');
            return true;
        }

        function OnClickCancelUpload() {
            $('#modal_upload_document').modal('hide');
        }
    </script>

}

