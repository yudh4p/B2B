
@{
    ViewBag.Title = "Index - Seller";
    Layout = "~/Views/Shared/_LayoutSeller.cshtml";
}

@model B2B_SCM.Models.Custom


<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h4 class="mt-0 header-title">Transaction Purchase Wheat - SELLER</h4>
                    <div class="row">
                        <div class="col-md-12">
                            <label class="form-label">Date</label>
                            <div class="input-group" style="width: 500px">
                                @Html.TextBoxFor(model => model.DateFrom, "{0:yyyy-MM-dd}", new { @class = "form-control", @type = "date", @id = "DateFrom" })
                                @Html.TextBoxFor(model => model.DateTo, "{0:yyyy-MM-dd}", new { @class = "form-control", @type = "date", @id = "DateTo" })
                                <button type="button" class="btn waves-effect waves-light btn-primary" onclick="load_table()">Apply</button>
                            </div>

                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover nowrap" id="table_data" style="width: 100%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>PNO</th>
                                    <th>Date</th>
                                    <th>Trade Qty (MT)</th>
                                    <th>Unit Price / MT</th>
                                    <th>Shipment From</th>
                                    <th>Shipment To</th>
                                    <th>Origin</th>
                                    <th>Shipper</th>
                                    <th>Seller</th>
                                    <th>Remark</th>
                                    <th>Status</th>
                                    <th>Last Updated By</th>
                                    <th>Last Updated Date</th>
                                    <th>PID</th>
                                    <th>Origin_Code</th>
                                    <th>Shipper_Code</th>
                                    <th>Seller_Code</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="modal_header_edit" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static" style="border: solid">
    <div class="modal-dialog modal-full-width modal-dialog-scrollable modal-dialog-centered">
        <div class="modal-content border border-primary">
            <div class="modal-header">
                <h4 class="modal-title" id="modalEditTitle">Purchase Wheat - EDIT</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <!-- Modal Body -->
            @Html.HiddenFor(model => model.PurchaseIDE)
            <div class="modal-body">

                <div class="row">
                    <div class="col-sm-5">
                        <div class="row clearfix">
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Purchase No</label>
                                    @Html.TextBoxFor(model => model.PurchaseNoE, new { @class = "form-control", @id = "PurchaseNoE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Trade Qty (MT)</label>
                                    @Html.TextBoxFor(model => model.TradeQtyE, new { @class = "form-control", @id = "TradeQtyE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Unit Price / MT (E)</label>
                                    @Html.TextBoxFor(model => model.UnitPriceE, new { @class = "form-control", @id = "UnitPriceE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Curr</label>
                                    @Html.TextBoxFor(model => model.Currency, new { @class = "form-control", @id = "Currency", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            @*<div class="col-sm-3">
                <div class="mb-3">
                    <label class="form-label">Unit Price / MT (F)</label>
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Recipient's username" aria-label="Recipient's username">
                        <button class="btn input-group-text btn-dark waves-effect waves-light" type="button">Button</button>
                    </div>
                </div>
            </div>*@
                        </div>

                        <div class="row clearfix">
                            <div class="col-sm-6">
                                <div class="mb-3">
                                    <label class="form-label">Shipment Periode (From)</label>
                                    @Html.TextBoxFor(model => model.ShipmentFromE, new { @class = "form-control", @id = "ShipmentFromE", @readonly = "readonly", @type = "date", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="mb-3">
                                    <label class="form-label">Shipment Periode (To)</label>
                                    @Html.TextBoxFor(model => model.ShipmentToE, new { @class = "form-control", @id = "ShipmentToE", @readonly = "readonly", @type = "date", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                        </div>


                        <div class="row clearfix">
                            <div class="col-sm-6">
                                <div class="mb-3">
                                    <label class="form-label">Origin</label>
                                    @Html.TextBoxFor(model => model.OriginE, new { @class = "form-control", @id = "OriginE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="mb-3">
                                    <label class="form-label">Shipper</label>
                                    @Html.TextBoxFor(model => model.ShipperE, new { @class = "form-control", @id = "ShipperE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-4" hidden>
                                <div class="mb-3">
                                    <label class="form-label">Seller</label>
                                    @Html.TextBoxFor(model => model.SellerE, new { @class = "form-control", @id = "SellerE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                        </div>

                        <div class="row clearfix">
                            <div class="col-sm-12">
                                <label class="form-label">Remark</label>
                                @Html.TextAreaFor(model => model.RemarkE, new { @class = "form-control", @id = "RemarkE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <ul class="nav nav-tabs nav-bordered">
                                    <li class="nav-item">
                                        <a href="#ltcT" data-bs-toggle="tab" aria-expanded="false" class="nav-link active">
                                            LTC
                                        </a>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane show active" id="ltcT">
                                        <div class="row">
                                            <div class="col-sm-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Comm Date</label>
                                                    @Html.TextBoxFor(model => model.CommDiscDateH, new { @class = "form-control", @id = "CommDiscDateH", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Comp Date</label>
                                                    @Html.TextBoxFor(model => model.CompDiscDateH, new { @class = "form-control", @id = "CompDiscDateH", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Dem/Des</label>
                                                    @Html.TextBoxFor(model => model.StatusDesDem, new { @class = "form-control", @id = "StatusDesDem", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Status</label>
                                                    @Html.TextBoxFor(model => model.StatusDesDemConfirm, new { @class = "form-control", @id = "StatusDesDemConfirm", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <ul class="nav nav-tabs nav-bordered">
                                    <li class="nav-item">
                                        <a href="#paymentT" data-bs-toggle="tab" aria-expanded="false" class="nav-link active">
                                            Payment
                                        </a>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane show active" id="paymentT">
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Due Date</label>
                                                    @Html.TextBoxFor(model => model.PaymentDueDate, new { @class = "form-control", @id = "PaymentDueDate", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                <div class="mb-3">
                                                    <label class="form-label">Payment Date</label>
                                                    @Html.TextBoxFor(model => model.PaymentDate, new { @class = "form-control", @id = "PaymentDate", @readonly = "readonly", @style = "background-color: #dee2e6" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="col-sm-7">
                        <div class="accordion custom-accordion" id="custom-accordion-one">
                            <div class="card mb-0">
                                <div class="card-header" id="headingNine">
                                    <h5 class="m-0 position-relative">
                                        <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapse1" aria-expanded="true" aria-controls="collapse1">
                                            Detail items <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                        </a>
                                    </h5>
                                </div>
                                <div id="collapse1" class="collapse show">
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered table-hover nowrap" id="table_data_item" style="width: 100%">
                                                <thead>
                                                    <tr>
                                                        <td rowspan="2">#</td>
                                                        <td rowspan="2">Wheat</td>
                                                        <td rowspan="2">Est. Qty</td>
                                                        <td rowspan="2">Final Qty</td>
                                                        <td rowspan="2">Final Price (MT)</td>
                                                        <td rowspan="2">Qty * Price</td>
                                                        <td colspan="4" style="text-align: center; font: bold">Loading Details</td>
                                                        <td colspan="4" style="text-align: center; font: bold">Discharge Details</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Port of Loading</td>
                                                        <td>ETA Load Port</td>
                                                        <td>ETB Load Port</td>
                                                        <td>ETD Load Port</td>
                                                        <td>Port of Discharge</td>
                                                        <td>ETA Disport</td>
                                                        <td>ETB Disport</td>
                                                        <td>ETC Disport</td>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="accordion custom-accordion" id="custom-accordion-one">
                            <div class="card mb-0">
                                <div class="card-header" id="headingFive">
                                    <h5 class="m-0 position-relative">
                                        <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapse2" aria-expanded="true" aria-controls="collapse2">
                                            Vessel Information <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                        </a>
                                    </h5>
                                </div>
                                <div id="collapse2" class="collapse show">
                                    <div class="card-body">
                                        <div class="row clearfix">
                                            <div class="col-sm-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Vessel Name</label>
                                                    @Html.TextBoxFor(model => model.VesselName, new { @class = "form-control", @id = "VesselName", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Vessel Detail</label>
                                                    @Html.TextBoxFor(model => model.VesselDetail, new { @class = "form-control", @id = "VesselDetail", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Demurage/Despatch</label>
                                                    @Html.TextBoxFor(model => model.DemDes, new { @class = "form-control", @id = "DemDes", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="mb-3">
                                                    <label class="form-label">Appointed Agent</label>
                                                    @Html.TextBoxFor(model => model.AppointAgent, new { @class = "form-control", @id = "AppointAgent", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="accordion custom-accordion" id="custom-accordion-one">
                            <div class="card mb-0">
                                <div class="card-header" id="headingNine">
                                    <h5 class="m-0 position-relative">
                                        <a class="custom-accordion-title text-reset d-block" data-bs-toggle="collapse" href="#collapse3" aria-expanded="true" aria-controls="collapse3">
                                            Document History <i class="mdi mdi-chevron-down accordion-arrow"></i>
                                        </a>
                                    </h5>
                                </div>
                                <div id="collapse3" class="collapse show">
                                    <div class="card-body">
                                        <div style="text-align: right">
                                            <a href="#" class="btn btn-outline-primary waves-effect waves-light" onclick="OnClickUpload()">Upload Doc</a>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered dt-responsive nowrap" id="table_data_doc" style="width: 100%">
                                                <thead>
                                                    <tr>
                                                        <th>#</th>
                                                        @*<th>Doc ID</th>*@
                                                        <th>Doc Type</th>
                                                        <th>Comment</th>
                                                        <th>Status</th>
                                                        <th>Uploader</th>
                                                        <th>Upload Date</th>
                                                        <th></th>
                                                        <th></th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" data-bs-dismiss="modal">Cancel</a>
                    <a href="#" class="btn btn-outline-warning waves-effect waves-light" onclick="OnRefreshModal()">Refresh</a>
                    @*<a href="#" class="btn btn-outline-primary waves-effect waves-light" onclick="OnClickUpload()">Upload Doc</a>*@
                    @*<button type="button" class="btn btn-outline-primary waves-effect waves-light" onclick="OnClickLTC()">LTC & Payment</button>*@
                </div>
            </div>
        </div>
    </div>
</div>


<div id="modal_upload_document" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg modal-dialog-scrollable modal-dialog-centered">
        <div class="modal-content border border-info">
            <div class="modal-header">
                <h4 class="modal-title">Upload Document</h4>
                @*<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>*@
            </div>
            <div class="modal-body">
                @Html.HiddenFor(x => x.PurchaseIDE2)
                <div id="_partial_upload_doc">
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelUpload()">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_conversation" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title" id="title-conversation">Coversation</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="conversation-list-card card">
                            <div class="card-body">
                                <div id="_partial_doc_chat" onload="">
                                </div>
                            </div>
                            <div class="p-3 conversation-input border-top">
                                <div class="row">
                                    <div class="col">
                                        <div>
                                            <textarea class="form-control" placeholder="Enter Message..." id="txtChat" name="txtChat" onkeypress="OnEnterSend(event)"></textarea>
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <button type="submit" onclick="OnSend()" class="btn btn-primary chat-send width-md waves-effect waves-light h-auto"><span class="d-none d-sm-inline-block me-2">Send</span> <i class="mdi mdi-send"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div style="text-align: right">
                            <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelConversation()">Cancel</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@using (Html.BeginForm("update_demdes", "seller", FormMethod.Post))
{
    <div id="modal_update_demdes" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border border-danger modal-sm">
                <div class="modal-header">
                    <h4 class="modal-title" id="title-conversation-demdes">Update Dem Des</h4>
                </div>
                @Html.HiddenFor(x => x.PurchaseIDE3)
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check mb-2 form-check-info">
                                <input class="form-check-input" type="radio" name="rbDemDes" id="rbDem" value="DEMURAGE">
                                <label class="form-check-label" for="rbDem">Demurage</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check mb-2 form-check-info">
                                <input class="form-check-input" type="radio" name="rbDemDes" id="rbDes" value="DESPATCH">
                                <label class="form-check-label" for="rbDes">Despatch</label>
                            </div>
                        </div>
                    </div>
                    @*<div class="row">
                            <div class="col-sm-12">
                                <div class="mb-3">
                                    <label class="form-label">Dem Rate</label>
                                    @Html.TextBoxFor(model => model.DemRate2, new { @class = "form-control", @id = "DemRate2", @type = "number", @style = "color: black" })
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="mb-3">
                                    <label class="form-label">Des Rate</label>
                                    @Html.TextBoxFor(model => model.DesRate2, new { @class = "form-control", @id = "DesRate2", @type = "number", @style = "color: black" })
                                </div>
                            </div>
                        </div>*@
                </div>
                <div class="modal-footer">
                    <div style="text-align: right">
                        <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelDEMDES()">Cancel</a>
                        <button type="submit" class="btn btn-outline-primary waves-effect waves-light" id="btnSubmit" onclick="return OnClickSave()">Update</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<div id="modal_history_file" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">History of files</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered dt-responsive nowrap" id="table_history_doc" style="width: 100%">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>ID</th>
                                    <th>Doc Type</th>
                                    <th>Comment</th>
                                    <th>Reply</th>
                                    <th>Status</th>
                                    <th>Uploader</th>
                                    <th>Upload Date</th>
                                    <th></th>
                                    <th></th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelHistoryDoc()">Cancel</a>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_ltc" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">LTC & Payment</h4>
            </div>
            <div class="modal-body">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row clearfix">
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Commence Discharge Date</label>
                                        @Html.TextBoxFor(model => model.CommDiscDate, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "CommDiscDate", @name = "CommDiscDate", @type = "text", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Complete Discharge Date</label>
                                        @Html.TextBoxFor(model => model.CompDiscDate, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "CompDiscDate", @name = "CompDiscDate", @type = "text", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="mb-3">
                                        <label class="form-label">Payment Due Date</label>
                                        @Html.TextBoxFor(model => model.PayDueDate, "{0:dd/MM/yyyy}", new { @class = "form-control", @id = "PayDueDate", @name = "PayDueDate", @type = "text", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12" style="text-align: right">
                                    <h2 id="txtStatusLTC"></h2>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelLTC()">Cancel</a>
                    <button type="button" class="btn btn-outline-primary waves-effect waves-light" onclick="OnClickSaveLTC()">Confirm</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modal_item_edit" class="modal fade" data-bs-keyboard="false" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content border border-danger">
            <div class="modal-header">
                <h4 class="modal-title">Edit Wheat</h4>
                @*<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>*@
            </div>
            <!-- Modal Body -->
            <div class="modal-body">
                @Html.HiddenFor(model => model.UID_TrxDtl)
                <div class="row">
                    <div class="col-sm-12">
                        <div class="row clearfix">
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Wheat</label>
                                    @Html.TextBoxFor(model => model.WheatCodeE, new { @class = "form-control", @id = "WheatCodeE", @name = "WheatCodeE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Qty (Est)</label>
                                    @Html.TextBoxFor(model => model.WheatQtyE, new { @class = "form-control numeric", @id = "WheatQtyE", @name = "WheatQtyE", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Final Qty</label>
                                    @Html.TextBoxFor(model => model.FinalQty, new { @class = "form-control numeric", @id = "FinalQty", @name = "FinalQty", @readonly = "readonly", @style = "color: black;background-color: #dee2e6" })
                                </div>
                            </div>
                            <div class="col-sm-3">
                                <div class="mb-3">
                                    <label class="form-label">Final Price (MT) (<span id="lblPriceMT" name="lblPriceMT"></span>)</label>
                                    @Html.TextBoxFor(model => model.FinalUnitPriceE, new { @class = "form-control", @id = "FinalUnitPriceE", @name = "FinalUnitPriceE" })
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div style="text-align: right">
                    <a href="#" class="btn btn-outline-danger waves-effect waves-light" onclick="OnClickCancelUpdateItem()">Cancel</a>
                    <button type="button" class="btn btn-outline-primary waves-effect waves-light" id="btnSubmit" onclick="return OnUpdateItem()">Submit</button>
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts
{
    <script src="/assets/libs/flatpickr/flatpickr.min.js"></script>
    <script src="/assets/libs/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>

    <script>

        function OnUpdateItem() {
            var isValid = confirm('Are you sure want to submit/update the transaction?');
            if (isValid == false) {
                return isValid;
            }

            var data = {
                uid: document.getElementById('UID_TrxDtl').value,
                wheat: '-',
                port: '',
                qty: '',
                eta: '',
                etb: '',
                etc: '',
                eta2: '',
                fp: document.getElementById('FinalUnitPriceE').value,
            };
            $.ajax({
            type: 'post',
            url: '@Url.Action("update_item", "home")',
            data: data,
            success: function(result) {
                if (result.Success) {
                    Swal.fire({
                        title: result.Message,
                        text: "",
                        icon: "info",
                        confirmButtonColor: "#28bb4b",
                        confirmButtonText: "Ok"
                    });

                    load_table_modal_item(document.getElementById('PurchaseIDE').value);
                    $('#modal_item_edit').modal('hide');
                }
                else {
                    Swal.fire({
                        title: result.Message,
                        text: "",
                        icon: "error",
                        confirmButtonColor: "#28bb4b",
                        confirmButtonText: "Ok"
                    });
                }
            }
            });
            return true;
        }

        function OnClickCancelUpdateItem() {
            $('#modal_item_edit').modal('hide');
        }
    </script>

    <script>
        //$("#ETADisc").flatpickr({ dateFormat: "d-m-Y" });
        //$("#ETBDisc").flatpickr({ dateFormat: "d-m-Y" });
        //$("#ETCDisc").flatpickr({ dateFormat: "d-m-Y" });

        //$("#CommDiscDate").flatpickr({ dateFormat: "d-m-Y" });
        //$("#CompDiscDate").flatpickr({ dateFormat: "d-m-Y" });
        //$("#PayDueDate").flatpickr({ dateFormat: "d-m-Y" });

        //function OnSaveFinalPriceConf() {
        //    if (document.getElementById('FinalUnitPrice').value == '' || document.getElementById('FinalUnitPrice').value == null) {
        //        Swal.fire({
        //            title: "Final price is blank!",
        //            text: "",
        //            icon: "error",
        //            confirmButtonColor: "#28bb4b",
        //            confirmButtonText: "Ok"
        //        });
        //    }
        //    else {
        //        Swal.fire({
        //            title: 'Are you sure want to save this?',
        //            text: "You won't be able to revert this!",
        //            icon: "warning",
        //            showCancelButton: !0,
        //            confirmButtonColor: "#28bb4b",
        //            cancelButtonColor: "#f34e4e",
        //            confirmButtonText: "Continue"
        //        }).then(function (e) {
        //            e.value && OnSaveFinalPrice()
        //        })
        //    }
        //    return true;
        //}

        @*function OnSaveFinalPrice() {
            var data = { Id: document.getElementById('PurchaseIDE').value, price: document.getElementById('FinalUnitPrice').value };
            $.ajax({
                type: 'post',
                url: '@Url.Action("update_fp", "seller")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                }
            });
            return true;
        }*@

        function OnClickLTC() {
            $('#modal_ltc').modal('show');
        }

        function OnClickCancelLTC() {
            $('#modal_ltc').modal('hide');
        }

        function OnClickSaveLTC() {
            var data = {
                PurchaseNo: document.getElementById('PurchaseIDE').value,
                commDate: document.getElementById('CommDiscDate').value,
                compDate: document.getElementById('CompDiscDate').value,
                dueDate: document.getElementById('PayDueDate').value
            };

            $.ajax({
                type: 'post',
                url: '@Url.Action("update_ltc", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table_doc(document.getElementById("PurchaseIDE").value);
                }
            });
            $('#modal_ltc').modal('hide');
            return true;
        }

        function OnEnterSend(e) {
            if (e.keyCode === 13) {
                e.preventDefault(); // Ensure it is only this code that runs
                OnSend();
            }

        }

        function OnSend() {
            //alert(document.getElementById('UID_Chat').value);
            //alert(document.getElementById('txtChat').value);
            var data = { uid: document.getElementById('UID_Chat').value, remark: document.getElementById('txtChat').value };
            $.ajax({
                type: 'post',
                url: '@Url.Action("insert_chat", "home")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        document.getElementById('txtChat').value = '';
                        $('#_partial_doc_chat').load('@Url.Action("_partial_doc_chat", "home")?uid=' + document.getElementById('UID_Chat').value);


                        var d = $('#divChat');
                        d.scrollTop(d.prop("scrollHeight"));
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table_modal_doc(document.getElementById("PurchaseIDE").value);
                }
            });
            return true;
        }


        $("#WheatCode").selectize();
        $("#WheatPort").selectize();



        function OnClickUpdateDEMDES() {
            if (document.getElementById('DemDes').value == 'DEMURAGE') {
                $("#rbDem").prop("checked", true);
            }
            else {
                $("#rbDes").prop("checked", true);
            }
            $('#modal_update_demdes').modal('show');
        }

        function OnClickCancelDEMDES() {
            $('#modal_update_demdes').modal('hide');
        }

        function OnClickSaveDEMDES(id, dem, ) {
            var isValid = confirm('Are you sure want to submit/update the transaction?');
            if (isValid == false) {
                return isValid;
            }
        }

        function OnRefreshModal() {
            OnClickEdit(document.getElementById('PurchaseIDE').value);
        }

        function OnClickEdit(id) {
            var data = { id: id };
            $.ajax({
                type: 'GET',
                url: '@Url.Action("get_header_trx", "seller")',
                data: data,
                success: function(result) {
                    if (result.success) {

                        document.getElementById('modalEditTitle').innerHTML = 'Purchase Wheat - View (#' + result.PurchaseNo + ') - SELLER';
                        document.getElementById('PurchaseIDE').value = result.PurchaseIDE;
                        document.getElementById('PurchaseNoE').value = result.PurchaseNo;
                        document.getElementById('TradeQtyE').value = result.TradeQty_C;
                        document.getElementById('UnitPriceE').value = result.UnitPrice_C;
                        document.getElementById('ShipmentFromE').value = result.ShipmentFrom;
                        document.getElementById('ShipmentToE').value = result.ShipmentTo;
                        document.getElementById('RemarkE').value = result.Remark;

                        document.getElementById('PurchaseIDE3').value = result.PurchaseIDE;

                        document.getElementById('OriginE').value = result.Origin_Name;
                        document.getElementById('ShipperE').value = result.Shipper_Name;
                        document.getElementById('SellerE').value = result.Seller_Name;
                        document.getElementById('Currency').value = result.Currency;

                        for (element of result.DocRequired.split(",")) {
                            $("#txtChkE" + element).prop("checked", true);
                        }

                        load_table_modal_item(id);
                        load_table_modal_doc(id);

                        GetVesselInfo(id);

                        document.getElementById('CommDiscDateH').value = result.CommDiscDate;
                        document.getElementById('CompDiscDateH').value = result.CompDiscDate;
                        document.getElementById('StatusDesDem').value = result.StatusDesDem;
                        document.getElementById('StatusDesDemConfirm').value = result.StatusDesDemConfirm;

                        if (result.StatusDesDem == '') {
                            //document.getElementById("btnProcessLTC").style.display = "none";
                            document.getElementById('StatusDesDemConfirm').value = '';
                            //document.getElementById("title-ltc").innerHTML = "LTC";
                        }
                        else {
                            if (result.StatusDesDemConfirm == 'WAITING APPROVED') {
                                //document.getElementById("title-ltc").innerHTML = "LTC - NEED CONFIRM";
                                //document.getElementById("btnProcessLTC").style.display = "block";
                            }
                            else {
                                //document.getElementById("title-ltc").innerHTML = "LTC";
                                if (result.StatusDesDem == 'DES') {
                                    document.getElementById('StatusDesDem').style.color = 'blue';
                                }
                                else {
                                    document.getElementById('StatusDesDem').style.color = 'red';
                                }
                                //document.getElementById("btnProcessLTC").style.display = "none";
                            }
                        }

                        //document.getElementById('FinalUnitPrice').value = result.FinalUnitPrice;
                        document.getElementById('PaymentDueDate').value = result.PaymentDueDate;
                        document.getElementById('PaymentDate').value = result.PaymentDate;

                        $('#modal_header_edit').modal('show');
                    } else {

                    }
                }
            });
        }

        function GetVesselInfo(id) {
            var data = { id: id };
            $.ajax({
                type: 'GET',
                url: '@Url.Action("get_header_vessel", "shipper")',
                data: data,
                success: function(result) {
                    if (result.success) {
                        document.getElementById('VesselName').value = result.VESSELNAME;
                        document.getElementById('VesselDetail').value = result.VESSELDETAIL;
                        document.getElementById('DemDes').value = result.RATES;
                        document.getElementById('AppointAgent').value = result.APPOINTAGENT;
                    } else {

                    }
                }
            });
        }

        $(document).ready(function () {
            load_table();
        });

        function load_table() {
            var table = $('#table_data').DataTable();
            table.destroy();
            $('#table_data').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_data_index", "seller")?' + "fromDate=" + document.getElementById('DateFrom').value + "&toDate=" + document.getElementById('DateTo').value,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": null, "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.STATUS == 'ACTIVE') {
                                return '<span data-toggle="tooltip" title="Edit" style="cursor: pointer" onclick="OnClickEdit(\'' + row.PURCHASENO2 + '\');"><i class="dripicons-document-edit"></i></span>';
                            }
                            else {
                                return '';
                            }
                        }
                    },
                    {
                        "data": "PNO", "autoWidth": true,
                    },
                    {
                        "data": "DATE", "autoWidth": true,
                    },
                    {
                        "data": "TRADEQTY", "autoWidth": true,
                    },
                    {
                        "data": "UNITPRICE", "autoWidth": true,
                    },
                    {
                        "data": "SHIPMENTFROM", "autoWidth": true,
                    },
                    {
                        "data": "SHIPMENTTO", "autoWidth": true,
                    },
                    {
                        "data": "ORIGIN_NAME", "autoWidth": true,
                    },
                    {
                        "data": "SHIPPER_NAME", "autoWidth": true,
                    },
                    {
                        "data": "SELLER_NAME", "autoWidth": true,
                    },
                    {
                        "data": "REMARK", "autoWidth": true,
                    },
                    {
                        "data": "CLOSED", "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.CLOSED == false) {
                                return '<span style="color: #60b1ff"> Open </span>';
                            }
                            else {
                                return '<span style="color: red"> Close </span>';
                            }
                        }
                    },
                    {
                        "data": "UPDBY", "autoWidth": true,
                    },
                    {
                        "data": "UPDDATE", "autoWidth": true,
                    },
                    {
                        "data": "PURCHASENO2", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "ORIGIN", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "SHIPPER", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "SELLER", "autoWidth": true, "visible": false,
                    },
                ],
                "bLengthChange": false,
                "bFilter": true,
                "order": [[1, "desc"]],
                scrollX: true,
            });
            return true;
        }


        function OnClickEditItem(id) {
            var data = { id: id };
            $.ajax({
                type: 'GET',
                url: '@Url.Action("get_item", "seller")',
                data: data,
                success: function(result) {
                    if (result.success) {
                        document.getElementById('UID_TrxDtl').value = result.UID;
                        document.getElementById('WheatCodeE').value = result.WHEATNAME;
                        document.getElementById('WheatQtyE').value = result.QTY;
                        document.getElementById('FinalQty').value = result.FINALQTY;
                        document.getElementById('FinalUnitPriceE').value = result.FINALPRICE;
                        document.getElementById('lblPriceMT').innerHTML = result.CURR;


                        $('#modal_item_edit').modal('show');
                    } else {

                    }
                }
            });
        }

        function load_table_modal_item(id) {
            var table = $('#table_data_item').DataTable();
            table.destroy();
            $('#table_data_item').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_modal_data_item", "seller")?' + "id=" + id,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": null, "autoWidth": true,
                        mRender: function (data, type, row) {
                            return '<span data-toggle="tooltip" title="Edit" style="cursor: pointer" onclick="OnClickEditItem(\'' + row.UID + '\');"><i class="dripicons-document-edit"></i></span>';
                        }
                    },
                    {
                        "data": "WHEATNAME", "autoWidth": true,
                    },
                    {
                        "data": "QTY_C", "autoWidth": true,
                    },
                    {
                        "data": "FQTY_C", "autoWidth": true,
                    },
                    {
                        "data": "FINALPRICE", "autoWidth": true,
                    },
                    {
                        "data": "PRICE", "autoWidth": true,
                    },
                    {
                        "data": "LOADPORTNAME", "autoWidth": true,
                    },
                    {
                        "data": "ETALOAD", "autoWidth": true,
                    },
                    {
                        "data": "ETBLOAD", "autoWidth": true,
                    },
                    {
                        "data": "ETDLOAD", "autoWidth": true,
                    },
                    {
                        "data": "DISCPORTNAME", "autoWidth": true,
                    },
                    {
                        "data": "ETADISC", "autoWidth": true,
                    },
                    {
                        "data": "ETBDISC", "autoWidth": true,
                    },
                    {
                        "data": "ETCDISC", "autoWidth": true,
                    },
                ],
                "bLengthChange": false,
                "bFilter": false,
                "bPaginate": false,
                "bInfo": false,
                "order": [[1, "asc"]],
            });
        }

        function load_table_modal_doc(id) {
            var table = $('#table_data_doc').DataTable();
            table.destroy();
            $('#table_data_doc').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_modal_data_doc", "seller")?' + "id=" + id,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": null, "autoWidth": false,
                        mRender: function (data, type, row) {

                            if (row.STATUS_CODE == '1') {
                                if (row.AUTH == "1") {
                                    if (row.TOTAL_CHAT != "0") {
                                        return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="dripicons-conversation"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Delete" style="cursor: pointer" onclick="OnConfirmDeleteDocument(\'' + row.UID + '\');"><i class="dripicons-document-delete"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                    }
                                    else {
                                        return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="dripicons-conversation"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Delete" style="cursor: pointer" onclick="OnConfirmDeleteDocument(\'' + row.UID + '\');"><i class="dripicons-document-delete"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                    }
                                }
                                else {
                                    if (row.TOTAL_CHAT != "0") {
                                        return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="dripicons-conversation"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                    }
                                    else {
                                        return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="dripicons-conversation"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                    }
                                }
                            }
                            else {
                                if (row.TOTAL_CHAT != "0") {
                                    return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span class="position-relative" data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="dripicons-conversation"></i><span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">' + row.TOTAL_CHAT + '</span></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                }
                                else {
                                    return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="Conversation" style="cursor: pointer" onclick="OnConversation(\'' + row.UID + '\',\'' + row.DOCTYPE + '\');"><i class="dripicons-conversation"></i></span>&nbsp;&nbsp;<span data-toggle="tooltip" title="History Files" style="cursor: pointer" onclick="load_table_history_doc(\'' + row.DOCTYPE_ID + '\',\'' + row.UID+ '\');"><i class="dripicons-box"></i></span></div>';
                                }
                            }
                        }
                    },
                    //{
                    //    "data": "UID", "autoWidth": true,
                    //},
                    {
                        "data": "DOCTYPE", "autoWidth": true,
                    },
                    {
                        "data": "REMARK", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "STATUS_NAME", "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.STATUS_CODE == '1') {
                                return '<span style="color: #F4D03F"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '2') {
                                return '<span style="color: red"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '3') {
                                return '<span style="color: green"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else {
                                return '<span style="color: #60b1ff"> ' + row.STATUS_NAME + ' </span>';
                            }
                        }
                    },
                    {
                        "data": "UPLOADER", "autoWidth": true,
                    },
                    {
                        "data": "UPLOAD_DATE", "autoWidth": true,
                    },
                    {
                        "data": "DOCTYPE_ID", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "STATUS_CODE", "autoWidth": true, "visible": false,
                    },
                ],
                "bLengthChange": false,
                "bFilter": false,
                "bPaginate": false,
                "bInfo": false,
                "order": [[7, "asc"]],
                //columnDefs: [
                //    {
                //        "width": "150px", "targets": [0]
                //    }
                //]
            });
        }

        function load_table_history_doc(type, uid) {
            $('#modal_history_file').modal('show');
            var pno = document.getElementById('PurchaseIDE').value;
            var table = $('#table_history_doc').DataTable();
            table.destroy();
            $('#table_history_doc').DataTable({
                "ajax": {
                    "url": '@Url.Action("load_modal_history_doc", "seller")?pno=' + pno + '&type=' + type + '&id=' + uid,
                    "type": "GET",
                    "datatype": "json",
                    dataSrc: function(data) {
                        return $.parseJSON(data.data);
                    }
                },
                "columns": [
                    {
                        "data": null, "autoWidth": false,
                        mRender: function (data, type, row) {
                            return '<div style="text-align: center;font-size: 20px"><span data-toggle="tooltip" title="Download" style="cursor: pointer" onclick="OnDownload(\'' + row.UID + '\');"><i class="dripicons-cloud-download"></i></span></div>';
                        }
                    },
                    {
                        "data": "UID", "autoWidth": true,
                    },
                    {
                        "data": "DOCTYPE2", "autoWidth": true,
                    },
                    {
                        "data": "REMARK", "autoWidth": true,
                    },
                    {
                        "data": "FEEDBACK", "autoWidth": true,
                    },
                    {
                        "data": "STATUS_NAME", "autoWidth": true,
                        mRender: function (data, type, row) {
                            if (row.STATUS_CODE == '1') {
                                return '<span style="color: #F4D03F"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '2') {
                                return '<span style="color: red"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else if (row.STATUS_CODE == '3') {
                                return '<span style="color: green"> ' + row.STATUS_NAME + ' </span>';
                            }
                            else {
                                return '<span style="color: #60b1ff"> ' + row.STATUS_NAME + ' </span>';
                            }
                        }
                    },
                    {
                        "data": "UPLOADER", "autoWidth": true,
                    },
                    {
                        "data": "UPLOAD_DATE", "autoWidth": true,
                    },
                    {
                        "data": "DOCTYPE_ID", "autoWidth": true, "visible": false,
                    },
                    {
                        "data": "STATUS_CODE", "autoWidth": true, "visible": false,
                    },
                ],
                "bLengthChange": false,
                "bFilter": false,
                "bPaginate": false,
                "bInfo": false,
                "order": [[1, "desc"]],
            });
        }

        $('#modal_conversation').on('shown.bs.modal', function () {
            document.getElementById('txtChat').value = '';
            document.getElementById('txtChat').focus();
        })


        $('#modal_conversation').on('hide.bs.modal', function () {
            load_table_modal_doc(document.getElementById("PurchaseIDE").value);
        })

        function OnConversation(id, type) {
            document.getElementById('title-conversation').innerHTML = 'Conversation (' + type + ')';
            $('#_partial_doc_chat').load('@Url.Action("_partial_doc_chat", "home")?uid=' + id);
            $('#modal_conversation').modal('show');
        }

        function OnDownload(id_) {
            var data = { Id: id_ };
            $.ajax({
                type: 'post',
                url: '@Url.Action("download", "seller")',
                data: data,
                success: function(result) {
                    if (!result.Success) {
                        Swal.fire({
                            title: "<span style='color:#71b6f9'>" + result.Message + "</span>",
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                }
            });
        }

        function OnConfirmDeleteDocument(id_) {
            Swal.fire({
                title: 'Are you sure want to delete this document?',
                text: "You won't be able to revert this!",
                icon: "warning",
                showCancelButton: !0,
                confirmButtonColor: "#28bb4b",
                cancelButtonColor: "#f34e4e",
                confirmButtonText: "Continue"
            }).then(function (e) {
                e.value && OnDeleteDocument(id_)
            })
            return true;
        }

        function OnDeleteDocument(id_) {
            var data = { Id: id_, purchaseno: document.getElementById("PurchaseIDE").value };
            $.ajax({
                type: 'post',
                url: '@Url.Action("delete_doc", "seller")',
                data: data,
                success: function(result) {
                    if (result.Success) {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "info",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    else {
                        Swal.fire({
                            title: result.Message,
                            text: "",
                            icon: "error",
                            confirmButtonColor: "#28bb4b",
                            confirmButtonText: "Ok"
                        });
                    }
                    load_table_modal_doc(document.getElementById("PurchaseIDE").value);
                }
            });
            return true;
        }

        function OnClickUpload() {
            $('#_partial_upload_doc').load('@Url.Action("_partial_upload_doc", "home")?id=' + document.getElementById('PurchaseIDE').value);
            document.getElementById('PurchaseIDE2').value = document.getElementById('PurchaseIDE').value;
            //$('#modal_header_edit').modal('hide');
            $('#modal_upload_document').modal('show');
        }

        function OnClickCancelUpload(){
            $('#modal_upload_document').modal('hide');
        }

        function OnClickCancelConversation() {
            var chat = document.getElementById('txtChat').value.trim();
            if (chat != "") {
                var isValid = confirm('Changes that you made may not be saved, leave site?');
                if (isValid == false) {
                    return isValid;
                }
            }
            $('#modal_conversation').modal('hide');
            return true;
        }

        function OnClickCancelHistoryDoc() {
            $('#modal_history_file').modal('hide');
        }
    </script>

}

